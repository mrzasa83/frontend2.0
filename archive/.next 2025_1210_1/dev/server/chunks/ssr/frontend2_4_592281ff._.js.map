{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/ui/Tabs.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { ReactNode } from 'react'\r\nimport { X } from 'lucide-react'\r\n\r\nexport interface Tab {\r\n  id: string\r\n  label: string | ReactNode\r\n  content: ReactNode\r\n  closeable?: boolean\r\n  onClose?: () => void\r\n}\r\n\r\ninterface TabsProps {\r\n  tabs: Tab[]\r\n  activeTab?: string\r\n  onTabChange?: (tabId: string) => void\r\n}\r\n\r\nexport default function Tabs({ tabs, activeTab, onTabChange }: TabsProps) {\r\n  const currentTab = activeTab || tabs[0]?.id\r\n  const activeContent = tabs.find(tab => tab.id === currentTab)?.content\r\n\r\n  const handleTabClick = (tabId: string) => {\r\n    if (onTabChange) {\r\n      onTabChange(tabId)\r\n    }\r\n  }\r\n\r\n  const handleClose = (e: React.MouseEvent, tab: Tab) => {\r\n    e.stopPropagation()\r\n    if (tab.onClose) {\r\n      tab.onClose()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      {/* Tab Headers */}\r\n      <div className=\"border-b border-slate-200\">\r\n        <div className=\"flex space-x-1 overflow-x-auto\">\r\n          {tabs.map(tab => (\r\n            <div\r\n              key={tab.id}\r\n              className={`flex items-center gap-2 px-6 py-3 font-medium text-sm transition-colors relative whitespace-nowrap cursor-pointer ${\r\n                currentTab === tab.id\r\n                  ? 'text-blue-600 border-b-2 border-blue-600'\r\n                  : 'text-slate-600 hover:text-slate-800'\r\n              }`}\r\n              onClick={() => handleTabClick(tab.id)}\r\n            >\r\n              <span>{tab.label}</span>\r\n              {tab.closeable && (\r\n                <button\r\n                  onClick={(e) => handleClose(e, tab)}\r\n                  className=\"hover:bg-slate-200 rounded p-0.5 transition-colors\"\r\n                  title=\"Close tab\"\r\n                >\r\n                  <X size={14} />\r\n                </button>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"py-6\">\r\n        {activeContent}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAmBe,SAAS,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,WAAW,EAAa;IACtE,MAAM,aAAa,aAAa,IAAI,CAAC,EAAE,EAAE;IACzC,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAA,MAAO,IAAI,EAAE,KAAK,aAAa;IAE/D,MAAM,iBAAiB,CAAC;QACtB,IAAI,aAAa;YACf,YAAY;QACd;IACF;IAEA,MAAM,cAAc,CAAC,GAAqB;QACxC,EAAE,eAAe;QACjB,IAAI,IAAI,OAAO,EAAE;YACf,IAAI,OAAO;QACb;IACF;IAEA,qBACE,gQAAC;QAAI,WAAU;;0BAEb,gQAAC;gBAAI,WAAU;0BACb,cAAA,gQAAC;oBAAI,WAAU;8BACZ,KAAK,GAAG,CAAC,CAAA,oBACR,gQAAC;4BAEC,WAAW,CAAC,kHAAkH,EAC5H,eAAe,IAAI,EAAE,GACjB,6CACA,uCACJ;4BACF,SAAS,IAAM,eAAe,IAAI,EAAE;;8CAEpC,gQAAC;8CAAM,IAAI,KAAK;;;;;;gCACf,IAAI,SAAS,kBACZ,gQAAC;oCACC,SAAS,CAAC,IAAM,YAAY,GAAG;oCAC/B,WAAU;oCACV,OAAM;8CAEN,cAAA,gQAAC,mNAAC;wCAAC,MAAM;;;;;;;;;;;;2BAfR,IAAI,EAAE;;;;;;;;;;;;;;;0BAwBnB,gQAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/users/UserTable.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Eye, Pencil } from 'lucide-react'\r\n\r\ntype User = {\r\n  id: number\r\n  username: string\r\n  name: string | null\r\n  email: string | null\r\n  nickname: string | null\r\n  phone: string | null\r\n  mobile: string | null\r\n  title: string | null\r\n  role: string | null\r\n  active: number | null\r\n  roles?: string[]\r\n}\r\n\r\ntype Props = {\r\n  users: User[]\r\n  onView: (user: User) => void\r\n  onEdit?: (user: User) => void\r\n  showActions?: boolean // Controls whether to show edit/view buttons\r\n}\r\n\r\nexport default function UserTable({ users, onView, onEdit, showActions = true }: Props) {\r\n  const [sortKey, setSortKey] = useState<keyof User>('username')\r\n  const [sortAsc, setSortAsc] = useState(true)\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n\r\n  // Filter users based on search\r\n  const filteredUsers = users.filter(user =>\r\n    user.username.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    user.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    user.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    user.title?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  )\r\n\r\n  // Sort users\r\n  const sortedUsers = [...filteredUsers].sort((a, b) => {\r\n    const valA = a[sortKey] || ''\r\n    const valB = b[sortKey] || ''\r\n    return sortAsc\r\n      ? String(valA).localeCompare(String(valB))\r\n      : String(valB).localeCompare(String(valA))\r\n  })\r\n\r\n  const handleSort = (key: keyof User) => {\r\n    if (sortKey === key) {\r\n      setSortAsc(!sortAsc)\r\n    } else {\r\n      setSortKey(key)\r\n      setSortAsc(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* Search Bar */}\r\n      <div className=\"mb-4\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search by username, name, email, or title...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\r\n        />\r\n      </div>\r\n\r\n      {/* Results Count */}\r\n      {searchTerm && (\r\n        <div className=\"mb-2 text-sm text-slate-600\">\r\n          Found {filteredUsers.length} user{filteredUsers.length !== 1 ? 's' : ''}\r\n        </div>\r\n      )}\r\n\r\n      {/* Table */}\r\n      <div className=\"border border-slate-200 rounded-lg overflow-hidden\">\r\n        <div className=\"overflow-x-auto max-h-[600px] overflow-y-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-slate-100 sticky top-0\">\r\n              <tr>\r\n                <th \r\n                  className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => handleSort('username')}\r\n                >\r\n                  Username\r\n                  {sortKey === 'username' && (\r\n                    <span className=\"ml-1\">{sortAsc ? '▲' : '▼'}</span>\r\n                  )}\r\n                </th>\r\n                <th \r\n                  className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => handleSort('name')}\r\n                >\r\n                  Name\r\n                  {sortKey === 'name' && (\r\n                    <span className=\"ml-1\">{sortAsc ? '▲' : '▼'}</span>\r\n                  )}\r\n                </th>\r\n                <th \r\n                  className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => handleSort('email')}\r\n                >\r\n                  Email\r\n                  {sortKey === 'email' && (\r\n                    <span className=\"ml-1\">{sortAsc ? '▲' : '▼'}</span>\r\n                  )}\r\n                </th>\r\n                <th \r\n                  className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => handleSort('title')}\r\n                >\r\n                  Title\r\n                  {sortKey === 'title' && (\r\n                    <span className=\"ml-1\">{sortAsc ? '▲' : '▼'}</span>\r\n                  )}\r\n                </th>\r\n                <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700\">\r\n                  Status\r\n                </th>\r\n                {showActions && (\r\n                  <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700\">Actions</th>\r\n                )}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {sortedUsers.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={showActions ? 6 : 5} className=\"px-4 py-8 text-center text-slate-500\">\r\n                    {searchTerm ? 'No users found matching your search' : 'No users found'}\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                sortedUsers.map((user) => (\r\n                  <tr key={user.id} className=\"border-t border-slate-200 hover:bg-slate-50 transition-colors\">\r\n                    <td className=\"px-4 py-3 font-mono text-sm font-semibold\">\r\n                      {user.username}\r\n                    </td>\r\n                    <td className=\"px-4 py-3 text-sm\">{user.name || '-'}</td>\r\n                    <td className=\"px-4 py-3 text-sm\">{user.email || '-'}</td>\r\n                    <td className=\"px-4 py-3 text-sm\">{user.title || '-'}</td>\r\n                    <td className=\"px-4 py-3 text-sm\">\r\n                      <span\r\n                        className={`px-2 py-1 rounded-full text-xs font-medium ${\r\n                          user.active === 1\r\n                            ? 'bg-green-100 text-green-700'\r\n                            : 'bg-red-100 text-red-700'\r\n                        }`}\r\n                      >\r\n                        {user.active === 1 ? 'Active' : 'Inactive'}\r\n                      </span>\r\n                    </td>\r\n                    {showActions && (\r\n                      <td className=\"px-4 py-3\">\r\n                        <div className=\"flex gap-2\">\r\n                          <button\r\n                            onClick={() => onView(user)}\r\n                            className=\"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                            title=\"View User\"\r\n                          >\r\n                            <Eye size={18} />\r\n                          </button>\r\n                          {onEdit && (\r\n                            <button\r\n                              onClick={() => onEdit(user)}\r\n                              className=\"p-2 text-green-600 hover:bg-green-50 rounded transition-colors\"\r\n                              title=\"Edit User\"\r\n                            >\r\n                              <Pencil size={18} />\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                    )}\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 428, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/users/UserForm.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport { X, Save } from 'lucide-react'\r\n\r\ntype User = {\r\n  id: number\r\n  username: string\r\n  name: string | null\r\n  email: string | null\r\n  nickname: string | null\r\n  phone: string | null\r\n  mobile: string | null\r\n  title: string | null\r\n  role: string | null\r\n  active: number | null\r\n}\r\n\r\ntype Props = {\r\n  user: User\r\n  mode: 'view' | 'edit'\r\n  onClose: () => void\r\n  onSave?: (user: User) => void\r\n}\r\n\r\nexport default function UserForm({ user, mode, onClose, onSave }: Props) {\r\n  const [formData, setFormData] = useState(user)\r\n  const isReadOnly = mode === 'view'\r\n  const [activeTab, setActiveTab] = useState('personal')\r\n\r\n  const handleChange = (field: keyof User, value: any) => {\r\n    if (isReadOnly) return\r\n    setFormData(prev => ({ ...prev, [field]: value }))\r\n  }\r\n\r\n  const handleSave = () => {\r\n    if (onSave) {\r\n      onSave(formData)\r\n    }\r\n  }\r\n\r\n  const inputClassName = `w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none ${\r\n    isReadOnly ? 'bg-slate-50 cursor-not-allowed' : ''\r\n  }`\r\n\r\n  // Personal Tab Content\r\n  const personalTab = (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Username *\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.username}\r\n            onChange={(e) => handleChange('username', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Full Name\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.name || ''}\r\n            onChange={(e) => handleChange('name', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Nickname\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.nickname || ''}\r\n            onChange={(e) => handleChange('nickname', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Email\r\n          </label>\r\n          <input\r\n            type=\"email\"\r\n            value={formData.email || ''}\r\n            onChange={(e) => handleChange('email', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Phone\r\n          </label>\r\n          <input\r\n            type=\"tel\"\r\n            value={formData.phone || ''}\r\n            onChange={(e) => handleChange('phone', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Mobile\r\n          </label>\r\n          <input\r\n            type=\"tel\"\r\n            value={formData.mobile || ''}\r\n            onChange={(e) => handleChange('mobile', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={formData.active === 1}\r\n            onChange={(e) => handleChange('active', e.target.checked ? 1 : 0)}\r\n            disabled={isReadOnly}\r\n            className=\"rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\r\n          />\r\n          <span className=\"text-sm font-medium text-slate-700\">Active User</span>\r\n        </label>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // Occupation Tab Content\r\n  const occupationTab = (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Job Title\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.title || ''}\r\n            onChange={(e) => handleChange('title', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Role\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.role || ''}\r\n            onChange={(e) => handleChange('role', e.target.value)}\r\n            readOnly={isReadOnly}\r\n            className={inputClassName}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"bg-slate-50 p-4 rounded-lg\">\r\n        <p className=\"text-sm text-slate-600\">\r\n          Additional occupation details can be added here in future updates.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const tabs = [\r\n    { id: 'personal', label: 'Personal', content: personalTab },\r\n    { id: 'occupation', label: 'Occupation', content: occupationTab },\r\n  ]\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-slate-200\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold text-slate-800\">\r\n              {mode === 'view' ? 'View User' : 'Edit User'}\r\n            </h2>\r\n            <p className=\"text-sm text-slate-600 mt-1\">\r\n              {mode === 'view' \r\n                ? 'User information (read-only)' \r\n                : 'Update user information'}\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            <X size={24} className=\"text-slate-600\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-auto p-6\">\r\n          <Tabs tabs={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-3 p-6 border-t border-slate-200\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            {mode === 'view' ? 'Close' : 'Cancel'}\r\n          </button>\r\n          {mode === 'edit' && (\r\n            <button\r\n              onClick={handleSave}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n            >\r\n              <Save size={18} />\r\n              Save Changes\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 896, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/users/UserEditTab.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport Tabs from '@/components/ui/Tabs'\nimport { Save, X, Key, Link2, Wrench } from 'lucide-react'\n\ntype User = {\n  id: number\n  username: string\n  name: string | null\n  email: string | null\n  nickname: string | null\n  phone: string | null\n  mobile: string | null\n  title: string | null\n  role: string | null\n  active: number | null\n  roles?: string[]\n  cc_name?: string | null\n  engineer_roles?: string[]\n}\n\ntype Role = {\n  id: number\n  name: string\n}\n\ntype EngineerRoleType = 'CAM' | 'PCB' | 'ASM'\n\ntype Props = {\n  user: User\n  roles?: Role[]\n  onSave: (user: User) => void\n  onCancel: () => void\n  isAdmin?: boolean\n}\n\nexport default function UserEditTab({ user, roles = [], onSave, onCancel, isAdmin = false }: Props) {\n  const [formData, setFormData] = useState(user)\n  const [hasChanges, setHasChanges] = useState(false)\n  const [innerTab, setInnerTab] = useState('personal')\n  \n  // Security tab state\n  const [newPassword, setNewPassword] = useState('')\n  const [confirmPassword, setConfirmPassword] = useState('')\n  const [passwordError, setPasswordError] = useState('')\n  const [resettingPassword, setResettingPassword] = useState(false)\n\n  // Roles tab state\n  const [selectedRoles, setSelectedRoles] = useState<string[]>(user.roles || [])\n  const [savingRoles, setSavingRoles] = useState(false)\n\n  // Control Center linking state\n  const [ccUsers, setCcUsers] = useState<string[]>([])\n  const [selectedCcName, setSelectedCcName] = useState<string>(user.cc_name || '')\n  const [loadingCcUsers, setLoadingCcUsers] = useState(false)\n  \n  // Engineer roles state\n  const [engineerRoles, setEngineerRoles] = useState<EngineerRoleType[]>(\n    (user.engineer_roles || []) as EngineerRoleType[]\n  )\n  const [savingEngineerRoles, setSavingEngineerRoles] = useState(false)\n\n  // Fetch CC users on mount\n  useEffect(() => {\n    if (isAdmin) {\n      fetchCcUsers()\n    }\n  }, [isAdmin])\n\n  const fetchCcUsers = async () => {\n    try {\n      setLoadingCcUsers(true)\n      const res = await fetch('/api/admin/cc-users')\n      if (res.ok) {\n        const data = await res.json()\n        setCcUsers(data.users || [])\n      }\n    } catch (error) {\n      console.error('Error fetching CC users:', error)\n    } finally {\n      setLoadingCcUsers(false)\n    }\n  }\n\n  const handleChange = (field: keyof User, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }))\n    setHasChanges(true)\n  }\n\n  const handleSave = () => {\n    onSave(formData)\n    setHasChanges(false)\n  }\n\n  const handlePasswordReset = async () => {\n    // Validate passwords\n    if (!newPassword) {\n      setPasswordError('Password is required')\n      return\n    }\n\n    if (newPassword.length < 6) {\n      setPasswordError('Password must be at least 6 characters')\n      return\n    }\n\n    if (newPassword !== confirmPassword) {\n      setPasswordError('Passwords do not match')\n      return\n    }\n\n    try {\n      setResettingPassword(true)\n      setPasswordError('')\n\n      const res = await fetch(`/api/users/${user.id}/password`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          newPassword,\n          confirmPassword \n        })\n      })\n\n      if (!res.ok) {\n        const data = await res.json()\n        throw new Error(data.error || 'Failed to reset password')\n      }\n\n      alert('Password reset successfully!')\n      setNewPassword('')\n      setConfirmPassword('')\n    } catch (error) {\n      console.error('Error resetting password:', error)\n      setPasswordError(error instanceof Error ? error.message : 'Failed to reset password')\n    } finally {\n      setResettingPassword(false)\n    }\n  }\n\n  const handleSaveRoles = async () => {\n    try {\n      setSavingRoles(true)\n\n      const res = await fetch(`/api/users/${user.id}/roles`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ roles: selectedRoles })\n      })\n\n      if (!res.ok) {\n        const data = await res.json()\n        throw new Error(data.error || 'Failed to update roles')\n      }\n\n      alert('Roles updated successfully! User must re-login for changes to take effect.')\n      setFormData(prev => ({ ...prev, roles: selectedRoles }))\n    } catch (error) {\n      console.error('Error updating roles:', error)\n      alert(error instanceof Error ? error.message : 'Failed to update roles')\n    } finally {\n      setSavingRoles(false)\n    }\n  }\n\n  const toggleRole = (roleName: string) => {\n    setSelectedRoles(prev => \n      prev.includes(roleName)\n        ? prev.filter(r => r !== roleName)\n        : [...prev, roleName]\n    )\n  }\n\n  const toggleEngineerRole = (role: EngineerRoleType) => {\n    setEngineerRoles(prev =>\n      prev.includes(role)\n        ? prev.filter(r => r !== role)\n        : [...prev, role]\n    )\n  }\n\n  const handleSaveEngineerRoles = async () => {\n    try {\n      setSavingEngineerRoles(true)\n\n      const res = await fetch('/api/admin/engineer-roles', {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          userId: user.id,\n          ccName: selectedCcName || null,\n          roles: engineerRoles\n        })\n      })\n\n      if (!res.ok) {\n        const data = await res.json()\n        throw new Error(data.error || 'Failed to update engineer roles')\n      }\n\n      alert('Control Center link and engineer roles updated successfully!')\n      setFormData(prev => ({ \n        ...prev, \n        cc_name: selectedCcName || null,\n        engineer_roles: engineerRoles \n      }))\n    } catch (error) {\n      console.error('Error updating engineer roles:', error)\n      alert(error instanceof Error ? error.message : 'Failed to update engineer roles')\n    } finally {\n      setSavingEngineerRoles(false)\n    }\n  }\n\n  const inputClassName = \"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\n  const errorClassName = \"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none bg-red-50\"\n\n  // Personal Tab Content\n  const personalTab = (\n    <div className=\"space-y-4\">\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Username *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.username}\n            onChange={(e) => handleChange('username', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Full Name\n          </label>\n          <input\n            type=\"text\"\n            value={formData.name || ''}\n            onChange={(e) => handleChange('name', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Nickname\n          </label>\n          <input\n            type=\"text\"\n            value={formData.nickname || ''}\n            onChange={(e) => handleChange('nickname', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Email\n          </label>\n          <input\n            type=\"email\"\n            value={formData.email || ''}\n            onChange={(e) => handleChange('email', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Phone\n          </label>\n          <input\n            type=\"tel\"\n            value={formData.phone || ''}\n            onChange={(e) => handleChange('phone', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Mobile\n          </label>\n          <input\n            type=\"tel\"\n            value={formData.mobile || ''}\n            onChange={(e) => handleChange('mobile', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n      </div>\n\n      <div>\n        <label className=\"flex items-center gap-2\">\n          <input\n            type=\"checkbox\"\n            checked={formData.active === 1}\n            onChange={(e) => handleChange('active', e.target.checked ? 1 : 0)}\n            className=\"rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\n          />\n          <span className=\"text-sm font-medium text-slate-700\">Active User</span>\n        </label>\n      </div>\n    </div>\n  )\n\n  // Occupation Tab Content\n  const occupationTab = (\n    <div className=\"space-y-4\">\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Job Title\n          </label>\n          <input\n            type=\"text\"\n            value={formData.title || ''}\n            onChange={(e) => handleChange('title', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Role\n          </label>\n          <input\n            type=\"text\"\n            value={formData.role || ''}\n            onChange={(e) => handleChange('role', e.target.value)}\n            className={inputClassName}\n          />\n        </div>\n      </div>\n\n      <div className=\"bg-blue-50 border border-blue-200 p-4 rounded-lg\">\n        <p className=\"text-sm text-blue-800\">\n          <strong>Note:</strong> Additional occupation details (department, manager, start date, etc.) can be added here in future updates.\n        </p>\n      </div>\n    </div>\n  )\n\n  // Security Tab Content (Admin only)\n  const securityTab = (\n    <div className=\"space-y-6\">\n      <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\n        <p className=\"text-sm text-amber-800\">\n          <strong>⚠️ Password Reset:</strong> This will immediately change the user's password. \n          The user should be notified of their new credentials.\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            New Password *\n          </label>\n          <input\n            type=\"password\"\n            value={newPassword}\n            onChange={(e) => {\n              setNewPassword(e.target.value)\n              setPasswordError('')\n            }}\n            className={passwordError ? errorClassName : inputClassName}\n            placeholder=\"Enter new password\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\n            Confirm Password *\n          </label>\n          <input\n            type=\"password\"\n            value={confirmPassword}\n            onChange={(e) => {\n              setConfirmPassword(e.target.value)\n              setPasswordError('')\n            }}\n            className={passwordError ? errorClassName : inputClassName}\n            placeholder=\"Confirm new password\"\n          />\n        </div>\n      </div>\n\n      {passwordError && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\n          <p className=\"text-sm text-red-700\">{passwordError}</p>\n        </div>\n      )}\n\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <p className=\"text-sm text-blue-800 font-semibold mb-2\">Password Requirements:</p>\n        <ul className=\"text-xs text-blue-700 space-y-1\">\n          <li>• Minimum 6 characters</li>\n          <li>• User will need to use this password on next login</li>\n        </ul>\n      </div>\n\n      <div className=\"flex justify-end\">\n        <button\n          onClick={handlePasswordReset}\n          disabled={resettingPassword || !newPassword || !confirmPassword}\n          className=\"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          <Key size={18} />\n          {resettingPassword ? 'Resetting...' : 'Reset Password'}\n        </button>\n      </div>\n    </div>\n  )\n\n  // Roles Tab Content (Admin only)\n  const rolesTab = (\n    <div className=\"space-y-6\">\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <p className=\"text-sm text-blue-800\">\n          <strong>Note:</strong> Role changes take effect immediately, but the user must re-login to see updated permissions.\n        </p>\n      </div>\n\n      {roles.length === 0 ? (\n        <div className=\"text-center py-8 text-slate-500\">\n          <p>No roles available. Create roles in Admin → Role Management first.</p>\n        </div>\n      ) : (\n        <div>\n          <p className=\"text-sm font-medium text-slate-700 mb-3\">\n            Assign Roles to {formData.name || formData.username}:\n          </p>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {roles.map(role => (\n              <button\n                key={role.id}\n                onClick={() => toggleRole(role.name)}\n                className={`px-4 py-3 rounded-lg text-sm font-medium transition-colors border-2 ${\n                  selectedRoles.includes(role.name)\n                    ? 'bg-blue-600 text-white border-blue-600'\n                    : 'bg-white text-slate-700 border-slate-300 hover:border-blue-300'\n                }`}\n              >\n                {role.name}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {selectedRoles.length > 0 && (\n        <div>\n          <p className=\"text-sm font-medium text-slate-700 mb-2\">Selected Roles:</p>\n          <div className=\"flex flex-wrap gap-2\">\n            {selectedRoles.map(role => (\n              <span\n                key={role}\n                className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium\"\n              >\n                {role}\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex justify-end\">\n        <button\n          onClick={handleSaveRoles}\n          disabled={savingRoles}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          <Save size={18} />\n          {savingRoles ? 'Saving...' : 'Save Roles'}\n        </button>\n      </div>\n    </div>\n  )\n\n  // Engineer Roles Tab Content (Admin only)\n  const engineerRolesTab = (\n    <div className=\"space-y-6\">\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <p className=\"text-sm text-blue-800\">\n          <strong>Control Center Integration:</strong> Link this user to their Control Center account and assign them to engineering role groups. Users in these groups will appear in the respective dropdowns when assigning jobs.\n        </p>\n      </div>\n\n      {/* Control Center Name Link */}\n      <div>\n        <h4 className=\"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2\">\n          <Link2 size={16} />\n          Control Center Username\n        </h4>\n        {loadingCcUsers ? (\n          <div className=\"text-sm text-slate-500\">Loading Control Center users...</div>\n        ) : (\n          <div>\n            <select\n              value={selectedCcName}\n              onChange={(e) => setSelectedCcName(e.target.value)}\n              className=\"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"\">-- Select Control Center User --</option>\n              {ccUsers.map(ccUser => (\n                <option key={ccUser} value={ccUser}>{ccUser}</option>\n              ))}\n            </select>\n            <p className=\"text-xs text-slate-500 mt-1\">\n              This links the app user to their Control Center identity for job tracking.\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* Engineer Role Assignments */}\n      <div>\n        <h4 className=\"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2\">\n          <Wrench size={16} />\n          Engineer Role Assignments\n        </h4>\n        <p className=\"text-xs text-slate-500 mb-3\">\n          Check the roles this user should appear in when assigning engineers to jobs.\n        </p>\n        <div className=\"grid grid-cols-3 gap-4\">\n          {(['CAM', 'PCB', 'ASM'] as EngineerRoleType[]).map(role => (\n            <label\n              key={role}\n              className={`flex items-center gap-3 p-4 rounded-lg border-2 cursor-pointer transition-colors ${\n                engineerRoles.includes(role)\n                  ? 'bg-blue-50 border-blue-500'\n                  : 'bg-white border-slate-200 hover:border-blue-300'\n              }`}\n            >\n              <input\n                type=\"checkbox\"\n                checked={engineerRoles.includes(role)}\n                onChange={() => toggleEngineerRole(role)}\n                className=\"w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\n              />\n              <div>\n                <span className=\"font-semibold text-slate-700\">{role}</span>\n                <p className=\"text-xs text-slate-500\">\n                  {role === 'CAM' && 'CAM Engineer dropdown'}\n                  {role === 'PCB' && 'PCB Engineer dropdown'}\n                  {role === 'ASM' && 'ASM Engineer dropdown'}\n                </p>\n              </div>\n            </label>\n          ))}\n        </div>\n      </div>\n\n      {/* Selected Summary */}\n      {(selectedCcName || engineerRoles.length > 0) && (\n        <div className=\"bg-slate-50 rounded-lg p-4 border border-slate-200\">\n          <h4 className=\"text-sm font-semibold text-slate-700 mb-2\">Current Settings:</h4>\n          <div className=\"text-sm text-slate-600 space-y-1\">\n            <p><strong>CC Name:</strong> {selectedCcName || 'Not linked'}</p>\n            <p><strong>Roles:</strong> {engineerRoles.length > 0 ? engineerRoles.join(', ') : 'None assigned'}</p>\n          </div>\n        </div>\n      )}\n\n      <div className=\"flex justify-end\">\n        <button\n          onClick={handleSaveEngineerRoles}\n          disabled={savingEngineerRoles}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          <Save size={18} />\n          {savingEngineerRoles ? 'Saving...' : 'Save CC Link & Roles'}\n        </button>\n      </div>\n    </div>\n  )\n\n  // Build tabs array based on admin status\n  const tabs = [\n    { id: 'personal', label: 'Personal', content: personalTab, closeable: false },\n    { id: 'occupation', label: 'Occupation', content: occupationTab, closeable: false },\n  ]\n\n  // Add Security and Roles tabs only for admins\n  if (isAdmin) {\n    tabs.push(\n      { id: 'security', label: 'Security', content: securityTab, closeable: false },\n      { id: 'roles', label: 'Roles', content: rolesTab, closeable: false },\n      { id: 'engineer', label: 'Engineer Roles', content: engineerRolesTab, closeable: false }\n    )\n  }\n\n  return (\n    <div>\n      {/* Action Bar */}\n      <div className=\"flex items-center justify-between mb-6 pb-4 border-b border-slate-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-slate-800\">\n            Editing: {formData.name || formData.username}\n          </h3>\n          {hasChanges && (\n            <p className=\"text-sm text-orange-600 mt-1\">\n              ⚠️ You have unsaved changes\n            </p>\n          )}\n        </div>\n        <div className=\"flex gap-3\">\n          <button\n            onClick={onCancel}\n            className=\"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors flex items-center gap-2\"\n          >\n            <X size={18} />\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={!hasChanges}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <Save size={18} />\n            Save Changes\n          </button>\n        </div>\n      </div>\n\n      {/* Form Tabs */}\n      <Tabs tabs={tabs} activeTab={innerTab} onTabChange={setInnerTab} />\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2130, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/users/UserAddForm.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport { X, Save, UserPlus } from 'lucide-react'\r\n\r\ntype NewUser = {\r\n  username: string\r\n  name: string\r\n  email: string\r\n  nickname: string\r\n  phone: string\r\n  mobile: string\r\n  title: string\r\n  role: string\r\n  password: string\r\n  active: number\r\n}\r\n\r\ntype Props = {\r\n  onClose: () => void\r\n  onSave: (user: NewUser) => void\r\n}\r\n\r\nexport default function UserAddForm({ onClose, onSave }: Props) {\r\n  const [activeTab, setActiveTab] = useState('personal')\r\n  const [formData, setFormData] = useState<NewUser>({\r\n    username: '',\r\n    name: '',\r\n    email: '',\r\n    nickname: '',\r\n    phone: '',\r\n    mobile: '',\r\n    title: '',\r\n    role: '',\r\n    password: '',\r\n    active: 1\r\n  })\r\n\r\n  const [confirmPassword, setConfirmPassword] = useState('')\r\n  const [errors, setErrors] = useState<{ [key: string]: string }>({})\r\n\r\n  const handleChange = (field: keyof NewUser, value: any) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }))\r\n    // Clear error for this field\r\n    if (errors[field]) {\r\n      setErrors(prev => {\r\n        const newErrors = { ...prev }\r\n        delete newErrors[field]\r\n        return newErrors\r\n      })\r\n    }\r\n  }\r\n\r\n  const validateForm = () => {\r\n    const newErrors: { [key: string]: string } = {}\r\n\r\n    if (!formData.username.trim()) {\r\n      newErrors.username = 'Username is required'\r\n    }\r\n\r\n    if (!formData.name.trim()) {\r\n      newErrors.name = 'Name is required'\r\n    }\r\n\r\n    if (!formData.email.trim()) {\r\n      newErrors.email = 'Email is required'\r\n    } else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) {\r\n      newErrors.email = 'Email is invalid'\r\n    }\r\n\r\n    if (!formData.password) {\r\n      newErrors.password = 'Password is required'\r\n    } else if (formData.password.length < 6) {\r\n      newErrors.password = 'Password must be at least 6 characters'\r\n    }\r\n\r\n    if (formData.password !== confirmPassword) {\r\n      newErrors.confirmPassword = 'Passwords do not match'\r\n    }\r\n\r\n    setErrors(newErrors)\r\n    return Object.keys(newErrors).length === 0\r\n  }\r\n\r\n  const handleSave = () => {\r\n    if (validateForm()) {\r\n      onSave(formData)\r\n    } else {\r\n      // If validation fails, show which tab has errors\r\n      if (errors.username || errors.name || errors.email || errors.nickname) {\r\n        setActiveTab('personal')\r\n      } else if (errors.title || errors.role) {\r\n        setActiveTab('occupation')\r\n      } else if (errors.password || errors.confirmPassword) {\r\n        setActiveTab('security')\r\n      }\r\n    }\r\n  }\r\n\r\n  const inputClassName = \"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\r\n  const errorClassName = \"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none bg-red-50\"\r\n\r\n  // Personal Tab Content\r\n  const personalTab = (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Username *\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.username}\r\n            onChange={(e) => handleChange('username', e.target.value)}\r\n            className={errors.username ? errorClassName : inputClassName}\r\n            placeholder=\"Enter username\"\r\n          />\r\n          {errors.username && (\r\n            <p className=\"text-red-600 text-xs mt-1\">{errors.username}</p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Full Name *\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.name}\r\n            onChange={(e) => handleChange('name', e.target.value)}\r\n            className={errors.name ? errorClassName : inputClassName}\r\n            placeholder=\"Enter full name\"\r\n          />\r\n          {errors.name && (\r\n            <p className=\"text-red-600 text-xs mt-1\">{errors.name}</p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Email *\r\n          </label>\r\n          <input\r\n            type=\"email\"\r\n            value={formData.email}\r\n            onChange={(e) => handleChange('email', e.target.value)}\r\n            className={errors.email ? errorClassName : inputClassName}\r\n            placeholder=\"user@example.com\"\r\n          />\r\n          {errors.email && (\r\n            <p className=\"text-red-600 text-xs mt-1\">{errors.email}</p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Nickname\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.nickname}\r\n            onChange={(e) => handleChange('nickname', e.target.value)}\r\n            className={inputClassName}\r\n            placeholder=\"Enter nickname\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Phone\r\n          </label>\r\n          <input\r\n            type=\"tel\"\r\n            value={formData.phone}\r\n            onChange={(e) => handleChange('phone', e.target.value)}\r\n            className={inputClassName}\r\n            placeholder=\"(555) 123-4567\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Mobile\r\n          </label>\r\n          <input\r\n            type=\"tel\"\r\n            value={formData.mobile}\r\n            onChange={(e) => handleChange('mobile', e.target.value)}\r\n            className={inputClassName}\r\n            placeholder=\"(555) 987-6543\"\r\n          />\r\n        </div>\r\n\r\n        <div className=\"col-span-2\">\r\n          <label className=\"flex items-center gap-2\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={formData.active === 1}\r\n              onChange={(e) => handleChange('active', e.target.checked ? 1 : 0)}\r\n              className=\"rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\r\n            />\r\n            <span className=\"text-sm font-medium text-slate-700\">Active User</span>\r\n          </label>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // Occupation Tab Content\r\n  const occupationTab = (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Job Title\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={formData.title}\r\n            onChange={(e) => handleChange('title', e.target.value)}\r\n            className={inputClassName}\r\n            placeholder=\"e.g., Engineer, Manager\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Role\r\n          </label>\r\n          <select\r\n            value={formData.role}\r\n            onChange={(e) => handleChange('role', e.target.value)}\r\n            className={inputClassName}\r\n          >\r\n            <option value=\"\">Select role...</option>\r\n            <option value=\"user\">User</option>\r\n            <option value=\"admin\">Admin</option>\r\n            <option value=\"manager\">Manager</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"bg-slate-50 p-4 rounded-lg\">\r\n        <p className=\"text-sm text-slate-600\">\r\n          Additional occupation details can be configured after user creation.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // Security Tab Content\r\n  const securityTab = (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"grid grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Password *\r\n          </label>\r\n          <input\r\n            type=\"password\"\r\n            value={formData.password}\r\n            onChange={(e) => handleChange('password', e.target.value)}\r\n            className={errors.password ? errorClassName : inputClassName}\r\n            placeholder=\"Enter password\"\r\n          />\r\n          {errors.password && (\r\n            <p className=\"text-red-600 text-xs mt-1\">{errors.password}</p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n            Confirm Password *\r\n          </label>\r\n          <input\r\n            type=\"password\"\r\n            value={confirmPassword}\r\n            onChange={(e) => {\r\n              setConfirmPassword(e.target.value)\r\n              if (errors.confirmPassword) {\r\n                setErrors(prev => {\r\n                  const newErrors = { ...prev }\r\n                  delete newErrors.confirmPassword\r\n                  return newErrors\r\n                })\r\n              }\r\n            }}\r\n            className={errors.confirmPassword ? errorClassName : inputClassName}\r\n            placeholder=\"Confirm password\"\r\n          />\r\n          {errors.confirmPassword && (\r\n            <p className=\"text-red-600 text-xs mt-1\">{errors.confirmPassword}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n        <p className=\"text-sm text-blue-800\">\r\n          <strong>Password Requirements:</strong>\r\n        </p>\r\n        <ul className=\"text-xs text-blue-700 mt-2 space-y-1\">\r\n          <li>• Minimum 6 characters</li>\r\n          <li>• User will be able to change password after first login</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const tabs = [\r\n    { id: 'personal', label: 'Personal', content: personalTab, closeable: false },\r\n    { id: 'occupation', label: 'Occupation', content: occupationTab, closeable: false },\r\n    { id: 'security', label: 'Security', content: securityTab, closeable: false },\r\n  ]\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-slate-200\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n              <UserPlus className=\"text-blue-600\" size={24} />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-slate-800\">Add New User</h2>\r\n              <p className=\"text-sm text-slate-600 mt-1\">Create a new user account</p>\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            <X size={24} className=\"text-slate-600\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-auto p-6\">\r\n          <Tabs tabs={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-3 p-6 border-t border-slate-200\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n          >\r\n            <Save size={18} />\r\n            Create User\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2886, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/app/%28dashboard%29/admin/users/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport UserTable from '@/components/users/UserTable'\r\nimport UserForm from '@/components/users/UserForm'\r\nimport UserEditTab from '@/components/users/UserEditTab'\r\nimport UserAddForm from '@/components/users/UserAddForm'\r\nimport { Plus, Shield } from 'lucide-react'\r\n\r\ntype User = {\r\n  id: number\r\n  username: string\r\n  name: string | null\r\n  email: string | null\r\n  nickname: string | null\r\n  phone: string | null\r\n  mobile: string | null\r\n  title: string | null\r\n  role: string | null\r\n  active: number | null\r\n  roles?: string[]\r\n}\r\n\r\ntype NewUser = {\r\n  username: string\r\n  name: string\r\n  email: string\r\n  nickname: string\r\n  phone: string\r\n  mobile: string\r\n  title: string\r\n  role: string\r\n  password: string\r\n  active: number\r\n}\r\n\r\ntype Role = {\r\n  id: number\r\n  name: string\r\n}\r\n\r\nexport default function AdminUserManagementPage() {\r\n  const [users, setUsers] = useState<User[]>([])\r\n  const [roles, setRoles] = useState<Role[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [viewUser, setViewUser] = useState<User | null>(null)\r\n  const [editingUsers, setEditingUsers] = useState<User[]>([])\r\n  const [activeTab, setActiveTab] = useState('all')\r\n  const [showAddUser, setShowAddUser] = useState(false)\r\n\r\n  useEffect(() => {\r\n    fetchData()\r\n  }, [])\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setLoading(true)\r\n      setError(null)\r\n      \r\n      const usersRes = await fetch('/api/users')\r\n      \r\n      if (!usersRes.ok) {\r\n        throw new Error('Failed to fetch users')\r\n      }\r\n      \r\n      const usersData = await usersRes.json()\r\n      setUsers(usersData)\r\n      \r\n      // Try to fetch roles, but don't fail if endpoint doesn't exist yet\r\n      try {\r\n        const rolesRes = await fetch('/api/roles')\r\n        if (rolesRes.ok) {\r\n          const rolesData = await rolesRes.json()\r\n          setRoles(rolesData)\r\n        }\r\n      } catch (roleError) {\r\n        console.warn('Could not fetch roles:', roleError)\r\n        // Continue without roles - can still manage users\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Error fetching data:', error)\r\n      setError(error instanceof Error ? error.message : 'Failed to load data')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleView = (user: User) => {\r\n    setViewUser(user)\r\n  }\r\n\r\n  const handleEdit = (user: User) => {\r\n    const alreadyEditing = editingUsers.find(u => u.id === user.id)\r\n    if (!alreadyEditing) {\r\n      setEditingUsers(prev => [...prev, user])\r\n    }\r\n    setActiveTab(`edit-${user.id}`)\r\n  }\r\n\r\n  const handleCloseEditTab = (userId: number) => {\r\n    setEditingUsers(prev => prev.filter(u => u.id !== userId))\r\n    setActiveTab('all')\r\n  }\r\n\r\n  const handleSave = async (user: User) => {\r\n    try {\r\n      // Save user basic info\r\n      const res = await fetch(`/api/users/${user.id}`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(user),\r\n      })\r\n      \r\n      const responseData = await res.json()\r\n      \r\n      if (!res.ok) {\r\n        throw new Error(responseData.error || responseData.details || 'Failed to save user')\r\n      }\r\n      \r\n      await fetchData()\r\n      handleCloseEditTab(user.id)\r\n      alert('User updated successfully!')\r\n      \r\n    } catch (error) {\r\n      console.error('Error saving user:', error)\r\n      alert(`Failed to save user: ${error instanceof Error ? error.message : 'Unknown error'}`)\r\n    }\r\n  }\r\n\r\n  const handleAddUser = async (newUser: NewUser) => {\r\n    try {\r\n      const res = await fetch('/api/users', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(newUser),\r\n      })\r\n\r\n      const responseData = await res.json()\r\n\r\n      if (!res.ok) {\r\n        throw new Error(responseData.error || 'Failed to create user')\r\n      }\r\n\r\n      await fetchData()\r\n      setShowAddUser(false)\r\n      alert('User created successfully!')\r\n    } catch (error) {\r\n      console.error('Error creating user:', error)\r\n      alert(`Failed to create user: ${error instanceof Error ? error.message : 'Unknown error'}`)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-8 bg-slate-200 rounded w-1/4 mb-4\"></div>\r\n          <div className=\"h-64 bg-slate-200 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\r\n          <p className=\"font-semibold\">Error loading data</p>\r\n          <p className=\"text-sm\">{error}</p>\r\n          <button \r\n            onClick={fetchData}\r\n            className=\"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const userListTab = (\r\n    <div>\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold text-slate-800\">\r\n            All Users ({users.length})\r\n          </h3>\r\n          <p className=\"text-sm text-slate-600 mt-1\">\r\n            Full user management with role assignment and password reset\r\n          </p>\r\n        </div>\r\n        <button \r\n          onClick={() => setShowAddUser(true)}\r\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\r\n        >\r\n          <Plus size={18} />\r\n          Add User\r\n        </button>\r\n      </div>\r\n      <UserTable \r\n        users={users} \r\n        onView={handleView} \r\n        onEdit={handleEdit}\r\n        showActions={true}\r\n      />\r\n    </div>\r\n  )\r\n\r\n  const tabs = [\r\n    { \r\n      id: 'all', \r\n      label: 'All Users', \r\n      content: userListTab,\r\n      closeable: false\r\n    },\r\n    ...editingUsers.map(user => ({\r\n      id: `edit-${user.id}`,\r\n      label: user.name || user.username,\r\n      content: (\r\n        <UserEditTab\r\n          user={user}\r\n          roles={roles}\r\n          onSave={handleSave}\r\n          onCancel={() => handleCloseEditTab(user.id)}\r\n          isAdmin={true}\r\n        />\r\n      ),\r\n      closeable: true,\r\n      onClose: () => handleCloseEditTab(user.id)\r\n    }))\r\n  ]\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-2xl font-bold text-slate-800 flex items-center gap-2\">\r\n          <Shield size={28} />\r\n          User Management\r\n        </h2>\r\n        <p className=\"text-slate-600 mt-1\">\r\n          Manage users, assign roles, and reset passwords (Admin only)\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"bg-white rounded-lg shadow\">\r\n        <div className=\"p-6\">\r\n          <Tabs tabs={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n        </div>\r\n      </div>\r\n\r\n      {/* View User Modal (read-only) */}\r\n      {viewUser && (\r\n        <UserForm\r\n          user={viewUser}\r\n          mode=\"view\"\r\n          onClose={() => setViewUser(null)}\r\n        />\r\n      )}\r\n\r\n      {/* Add User Modal */}\r\n      {showAddUser && (\r\n        <UserAddForm\r\n          onClose={() => setShowAddUser(false)}\r\n          onSave={handleAddUser}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}