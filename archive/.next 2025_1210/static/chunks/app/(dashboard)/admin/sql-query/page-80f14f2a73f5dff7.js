(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{1190:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(1858).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},1858:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var r=s(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:n="",children:d,iconNode:o,...c},x)=>(0,r.createElement)("svg",{ref:x,...i,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:l("lucide",n),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]])),d=(e,t)=>{let s=(0,r.forwardRef)(({className:s,...i},d)=>(0,r.createElement)(n,{ref:d,iconNode:t,className:l(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...i}));return s.displayName=a(e),s}},2579:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(5155),a=s(2115),l=s(1190),i=s(1858);let n=(0,i.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),d=(0,i.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),o=[{id:"Paradigm",name:"Paradigm",type:"MS SQL",description:"Paradigm database"},{id:"frontEnd2.0",name:"frontEnd2.0",type:"MySQL",description:"Primary application database"},{id:"Control Center",name:"Control Center",type:"MySQL",description:"Secondary control database"},{id:"Engenix",name:"Engenix",type:"MS SQL",description:"Engenix database"}],c={"frontEnd2.0":["SELECT * FROM items LIMIT 10;","SELECT apcPN, customer, currentRev FROM items WHERE customer IS NOT NULL LIMIT 25;","SELECT item_type_id, COUNT(*) as count FROM items GROUP BY item_type_id;"],"Control Center":["SHOW TABLES;","SELECT * FROM your_table LIMIT 10;"],Paradigm:["SELECT TOP 10 * FROM your_table;","SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE';"],Engenix:["SELECT TOP 10 * FROM your_table;","SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE';"]};function x(){let[e,t]=(0,a.useState)("Paradigm"),[s,i]=(0,a.useState)(""),[x,m]=(0,a.useState)(!1),[u,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),g=async()=>{if(!s.trim())return void alert("Please enter a query");m(!0),b(null),h(null);try{let t=await fetch("/api/admin/query-database",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:e,query:s.trim()})}),r=await t.json();if(!t.ok)throw Error(r.error||r.details||"Query failed");h(r)}catch(e){b(e instanceof Error?e.message:String(e))}finally{m(!1)}},j=o.find(t=>t.id===e);return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"SQL Query Tool"}),(0,r.jsx)("p",{className:"text-slate-600 mb-6",children:"Execute read-only queries against connected databases"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Database:"}),(0,r.jsx)("select",{value:e,onChange:e=>t(e.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:o.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.type,")"]},e.id))}),j&&(0,r.jsx)("span",{className:"text-xs text-slate-500",children:j.description})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{i(""),h(null),b(null)},className:"px-3 py-1 text-sm text-slate-600 hover:bg-slate-100 rounded transition-colors flex items-center gap-1",children:[(0,r.jsx)(l.A,{size:14}),"Clear"]}),(0,r.jsxs)("button",{onClick:g,disabled:x||!s.trim(),className:"px-4 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[(0,r.jsx)(n,{size:14}),x?"Executing...":"Execute"]})]})]}),(0,r.jsx)("textarea",{value:s,onChange:e=>i(e.target.value),placeholder:"Enter your SELECT query here...",rows:12,className:"w-full px-4 py-3 border border-slate-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"}),(0,r.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-xs text-slate-500",children:[(0,r.jsx)("strong",{children:"Note:"})," Only SELECT queries are allowed for safety"]}),u&&(0,r.jsxs)("div",{className:"text-xs text-slate-600",children:["Executed in ",u.executionTime,"ms"]})]})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("div",{className:"text-red-600 font-semibold text-sm",children:"Error:"}),(0,r.jsx)("div",{className:"text-red-700 text-sm flex-1 font-mono",children:p})]})}),u&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-slate-800",children:"Query Results"}),(0,r.jsxs)("p",{className:"text-sm text-slate-600",children:[u.rowCount," rows returned"]})]}),u.rowCount>0&&(0,r.jsxs)("button",{onClick:()=>{if(!u||0===u.results.length)return;let e=new Blob([[u.columns.join(","),...u.results.map(e=>u.columns.map(t=>{let s=e[t];if(null==s)return"";let r=String(s);return r.includes(",")||r.includes('"')||r.includes("\n")?`"${r.replace(/"/g,'""')}"`:r}).join(","))].join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`query_result_${Date.now()}.csv`,s.click(),URL.revokeObjectURL(t)},className:"px-3 py-1 text-sm bg-slate-100 hover:bg-slate-200 rounded transition-colors flex items-center gap-2",children:[(0,r.jsx)(d,{size:14}),"Export CSV"]})]}),u.rowCount>0?(0,r.jsx)("div",{className:"overflow-x-auto max-h-96",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{className:"bg-slate-100 sticky top-0",children:(0,r.jsx)("tr",{children:u.columns.map((e,t)=>(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium text-slate-700 whitespace-nowrap",children:e},t))})}),(0,r.jsx)("tbody",{children:u.results.map((e,t)=>(0,r.jsx)("tr",{className:"border-t border-slate-200 hover:bg-slate-50",children:u.columns.map((t,s)=>(0,r.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-slate-600",children:null===e[t]?(0,r.jsx)("span",{className:"text-slate-400 italic",children:"null"}):String(e[t])},s))},t))})]})}):(0,r.jsx)("div",{className:"p-8 text-center text-slate-500",children:"Query executed successfully but returned no rows"})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"font-semibold text-slate-800 mb-4",children:"Example Queries"}),(0,r.jsx)("div",{className:"space-y-2",children:c[e]?.map((e,t)=>(0,r.jsx)("button",{onClick:()=>{i(e)},className:"w-full text-left px-3 py-2 text-xs font-mono bg-slate-50 hover:bg-slate-100 rounded border border-slate-200 transition-colors break-all",children:e},t))})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-blue-900 text-sm mb-2",children:"Tips"}),(0,r.jsxs)("ul",{className:"text-xs text-blue-800 space-y-1",children:[(0,r.jsx)("li",{children:"• Use LIMIT (MySQL) or TOP (MS SQL) to restrict results"}),(0,r.jsx)("li",{children:"• Click example queries to insert them"}),(0,r.jsx)("li",{children:"• Results are automatically formatted"}),(0,r.jsx)("li",{children:"• Export large result sets to CSV"}),(0,r.jsx)("li",{children:"• Queries timeout after 30 seconds"})]})]}),(0,r.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-orange-900 text-sm mb-2",children:"⚠️ Safety"}),(0,r.jsxs)("ul",{className:"text-xs text-orange-800 space-y-1",children:[(0,r.jsx)("li",{children:"• Only SELECT queries allowed"}),(0,r.jsx)("li",{children:"• No modifications to data"}),(0,r.jsx)("li",{children:"• No schema changes permitted"}),(0,r.jsx)("li",{children:"• All queries are logged"})]})]})]})]})]})}},4277:(e,t,s)=>{Promise.resolve().then(s.bind(s,2579))}},e=>{e.O(0,[441,826,358],()=>e(e.s=4277)),_N_E=e.O()}]);