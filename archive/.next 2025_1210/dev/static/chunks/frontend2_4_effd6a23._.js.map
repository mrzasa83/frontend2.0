{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/ui/Tabs.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { ReactNode } from 'react'\r\nimport { X } from 'lucide-react'\r\n\r\nexport interface Tab {\r\n  id: string\r\n  label: string | ReactNode\r\n  content: ReactNode\r\n  closeable?: boolean\r\n  onClose?: () => void\r\n}\r\n\r\ninterface TabsProps {\r\n  tabs: Tab[]\r\n  activeTab?: string\r\n  onTabChange?: (tabId: string) => void\r\n}\r\n\r\nexport default function Tabs({ tabs, activeTab, onTabChange }: TabsProps) {\r\n  const currentTab = activeTab || tabs[0]?.id\r\n  const activeContent = tabs.find(tab => tab.id === currentTab)?.content\r\n\r\n  const handleTabClick = (tabId: string) => {\r\n    if (onTabChange) {\r\n      onTabChange(tabId)\r\n    }\r\n  }\r\n\r\n  const handleClose = (e: React.MouseEvent, tab: Tab) => {\r\n    e.stopPropagation()\r\n    if (tab.onClose) {\r\n      tab.onClose()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      {/* Tab Headers */}\r\n      <div className=\"border-b border-slate-200\">\r\n        <div className=\"flex space-x-1 overflow-x-auto\">\r\n          {tabs.map(tab => (\r\n            <div\r\n              key={tab.id}\r\n              className={`flex items-center gap-2 px-6 py-3 font-medium text-sm transition-colors relative whitespace-nowrap cursor-pointer ${\r\n                currentTab === tab.id\r\n                  ? 'text-blue-600 border-b-2 border-blue-600'\r\n                  : 'text-slate-600 hover:text-slate-800'\r\n              }`}\r\n              onClick={() => handleTabClick(tab.id)}\r\n            >\r\n              <span>{tab.label}</span>\r\n              {tab.closeable && (\r\n                <button\r\n                  onClick={(e) => handleClose(e, tab)}\r\n                  className=\"hover:bg-slate-200 rounded p-0.5 transition-colors\"\r\n                  title=\"Close tab\"\r\n                >\r\n                  <X size={14} />\r\n                </button>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"py-6\">\r\n        {activeContent}\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":["c","_c","ReactNode","X","Tab","id","label","content","closeable","onClose","TabsProps","tabs","activeTab","onTabChange","tabId","Tabs","t0","$","$i","Symbol","for","currentTab","t1","find","tab","activeContent","t2","handleTabClick","handleClose","_TabsHandleClose","t3","t4","tab_1","Tabs[tabs.map() > <div>.onClick]","e_0","e","map","t5","t6","tab_0","stopPropagation"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/products/EditableProductTable.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { Eye, Save, X, Edit2 } from 'lucide-react'\r\n\r\ntype Product = {\r\n  id: number\r\n  apcPN: string\r\n  customer: string | null\r\n  customerPN: string | null\r\n  buildRev: string | null\r\n  currentRev: string | null\r\n  description: string | null\r\n  fullPath: string | null\r\n  item_type_name: string | null\r\n  item_type_id: number\r\n  createdAt: string\r\n}\r\n\r\ntype TableState = {\r\n  search: string\r\n  sortKey: keyof Product\r\n  sortAsc: boolean\r\n  pageSize: number\r\n  page: number\r\n  typeFilter: string\r\n}\r\n\r\ntype Props = {\r\n  products: Product[]\r\n  onView: (product: Product) => void\r\n  onEdit: (product: Product) => void\r\n  onSave: (product: Product) => Promise<void>\r\n  tableState: TableState\r\n  onTableStateChange: (state: TableState) => void\r\n  isAdmin: boolean\r\n}\r\n\r\nexport default function EditableProductTable({ \r\n  products, \r\n  onView, \r\n  onEdit, \r\n  onSave,\r\n  tableState, \r\n  onTableStateChange,\r\n  isAdmin \r\n}: Props) {\r\n  const { search, sortKey, sortAsc, pageSize, page, typeFilter } = tableState\r\n  const [editingRow, setEditingRow] = useState<number | null>(null)\r\n  const [editedData, setEditedData] = useState<Partial<Product>>({})\r\n  const [saving, setSaving] = useState(false)\r\n\r\n  const updateState = (updates: Partial<TableState>) => {\r\n    onTableStateChange({ ...tableState, ...updates })\r\n  }\r\n\r\n  const productTypes = Array.from(\r\n    new Set(products.map(p => p.item_type_name).filter((t): t is string => t !== null && t !== undefined))\r\n  ).sort()\r\n\r\n  const filtered = products.filter((p) => {\r\n    const matchesSearch = \r\n      p.apcPN.toLowerCase().includes(search.toLowerCase()) ||\r\n      p.customer?.toLowerCase().includes(search.toLowerCase()) ||\r\n      p.customerPN?.toLowerCase().includes(search.toLowerCase()) ||\r\n      p.description?.toLowerCase().includes(search.toLowerCase())\r\n    \r\n    const matchesType = !typeFilter || typeFilter === 'all' || p.item_type_name === typeFilter\r\n    \r\n    return matchesSearch && matchesType\r\n  })\r\n\r\n  const sorted = [...filtered].sort((a, b) => {\r\n    const valA = a[sortKey] || ''\r\n    const valB = b[sortKey] || ''\r\n    return sortAsc\r\n      ? String(valA).localeCompare(String(valB))\r\n      : String(valB).localeCompare(String(valA))\r\n  })\r\n\r\n  const paginated = sorted.slice(page * pageSize, (page + 1) * pageSize)\r\n  const totalPages = Math.ceil(filtered.length / pageSize)\r\n\r\n  const handleStartEdit = (product: Product) => {\r\n    setEditingRow(product.id)\r\n    setEditedData({\r\n      customer: product.customer,\r\n      customerPN: product.customerPN,\r\n      currentRev: product.currentRev,\r\n      description: product.description\r\n    })\r\n  }\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingRow(null)\r\n    setEditedData({})\r\n  }\r\n\r\n  const handleSaveEdit = async (product: Product) => {\r\n    setSaving(true)\r\n    try {\r\n      await onSave({\r\n        ...product,\r\n        ...editedData\r\n      })\r\n      setEditingRow(null)\r\n      setEditedData({})\r\n    } catch (error) {\r\n      console.error('Error saving:', error)\r\n    } finally {\r\n      setSaving(false)\r\n    }\r\n  }\r\n\r\n  const handleFieldChange = (field: keyof Product, value: string) => {\r\n    setEditedData(prev => ({ ...prev, [field]: value }))\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex justify-between items-center mb-4 gap-4\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search products...\"\r\n          value={search}\r\n          onChange={(e) => updateState({ search: e.target.value, page: 0 })}\r\n          className=\"border border-slate-300 px-3 py-2 rounded-lg flex-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\r\n        />\r\n        \r\n        <select\r\n          value={typeFilter || 'all'}\r\n          onChange={(e) => updateState({ typeFilter: e.target.value, page: 0 })}\r\n          className=\"border border-slate-300 px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\r\n        >\r\n          <option value=\"all\">All Types</option>\r\n          {productTypes.map(type => (\r\n            <option key={type} value={type}>{type}</option>\r\n          ))}\r\n        </select>\r\n\r\n        <select\r\n          value={pageSize}\r\n          onChange={(e) => updateState({ pageSize: Number(e.target.value), page: 0 })}\r\n          className=\"border border-slate-300 px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none\"\r\n        >\r\n          {[25, 50, 100, 250].map((size) => (\r\n            <option key={size} value={size}>\r\n              Show {size}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"border border-slate-200 rounded-lg overflow-hidden\">\r\n        <table className=\"w-full\">\r\n          <thead className=\"bg-slate-100\">\r\n            <tr>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => sortKey === 'apcPN' ? updateState({ sortAsc: !sortAsc }) : updateState({ sortKey: 'apcPN' })}>\r\n                Part Number {sortKey === 'apcPN' && (sortAsc ? '▲' : '▼')}\r\n              </th>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => sortKey === 'item_type_name' ? updateState({ sortAsc: !sortAsc }) : updateState({ sortKey: 'item_type_name' })}>\r\n                Type {sortKey === 'item_type_name' && (sortAsc ? '▲' : '▼')}\r\n              </th>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => sortKey === 'customer' ? updateState({ sortAsc: !sortAsc }) : updateState({ sortKey: 'customer' })}>\r\n                Customer {sortKey === 'customer' && (sortAsc ? '▲' : '▼')}\r\n              </th>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => sortKey === 'customerPN' ? updateState({ sortAsc: !sortAsc }) : updateState({ sortKey: 'customerPN' })}>\r\n                Customer PN {sortKey === 'customerPN' && (sortAsc ? '▲' : '▼')}\r\n              </th>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700 cursor-pointer hover:bg-slate-200\"\r\n                  onClick={() => sortKey === 'currentRev' ? updateState({ sortAsc: !sortAsc }) : updateState({ sortKey: 'currentRev' })}>\r\n                Part Rev {sortKey === 'currentRev' && (sortAsc ? '▲' : '▼')}\r\n              </th>\r\n              <th className=\"text-left px-4 py-3 font-medium text-sm text-slate-700\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {paginated.map((product) => {\r\n              const isEditing = editingRow === product.id\r\n              \r\n              return (\r\n                <tr key={product.id} className={`border-t border-slate-200 ${isEditing ? 'bg-blue-50' : 'hover:bg-slate-50'} transition-colors`}>\r\n                  <td className=\"px-4 py-3 font-mono text-sm font-semibold\">{product.apcPN}</td>\r\n                  <td className=\"px-4 py-3 text-sm\">\r\n                    <span className=\"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs\">\r\n                      {product.item_type_name || 'Unknown'}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-4 py-3 text-sm\">\r\n                    {isEditing ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editedData.customer ?? product.customer ?? ''}\r\n                        onChange={(e) => handleFieldChange('customer', e.target.value)}\r\n                        className=\"w-full px-2 py-1 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none\"\r\n                      />\r\n                    ) : (\r\n                      product.customer || '-'\r\n                    )}\r\n                  </td>\r\n                  <td className=\"px-4 py-3 text-sm\">\r\n                    {isEditing ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editedData.customerPN ?? product.customerPN ?? ''}\r\n                        onChange={(e) => handleFieldChange('customerPN', e.target.value)}\r\n                        className=\"w-full px-2 py-1 border border-slate-300 rounded text-sm font-mono focus:ring-2 focus:ring-blue-500 outline-none\"\r\n                      />\r\n                    ) : (\r\n                      <span className=\"font-mono\">{product.customerPN || '-'}</span>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"px-4 py-3 text-sm\">\r\n                    {isEditing ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editedData.currentRev ?? product.currentRev ?? ''}\r\n                        onChange={(e) => handleFieldChange('currentRev', e.target.value)}\r\n                        className=\"w-full px-2 py-1 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none\"\r\n                      />\r\n                    ) : (\r\n                      product.currentRev || '-'\r\n                    )}\r\n                  </td>\r\n                  <td className=\"px-4 py-3\">\r\n                    {isEditing ? (\r\n                      <div className=\"flex gap-2\">\r\n                        <button\r\n                          onClick={() => handleSaveEdit(product)}\r\n                          disabled={saving}\r\n                          className=\"p-2 text-green-600 hover:bg-green-50 rounded transition-colors disabled:opacity-50\"\r\n                          title=\"Save Changes\"\r\n                        >\r\n                          <Save size={18} />\r\n                        </button>\r\n                        <button\r\n                          onClick={handleCancelEdit}\r\n                          disabled={saving}\r\n                          className=\"p-2 text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50\"\r\n                          title=\"Cancel\"\r\n                        >\r\n                          <X size={18} />\r\n                        </button>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"flex gap-2\">\r\n                        <button\r\n                          onClick={() => onView(product)}\r\n                          className=\"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                          title=\"View Product\"\r\n                        >\r\n                          <Eye size={18} />\r\n                        </button>\r\n                        {isAdmin && (\r\n                          <button\r\n                            onClick={() => handleStartEdit(product)}\r\n                            className=\"p-2 text-orange-600 hover:bg-orange-50 rounded transition-colors\"\r\n                            title=\"Quick Edit\"\r\n                          >\r\n                            <Edit2 size={18} />\r\n                          </button>\r\n                        )}\r\n                        <button\r\n                          onClick={() => onEdit(product)}\r\n                          className=\"p-2 text-green-600 hover:bg-green-50 rounded transition-colors\"\r\n                          title=\"Full Edit\"\r\n                        >\r\n                          <Edit2 size={18} />\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              )\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <div className=\"flex justify-between items-center mt-4\">\r\n        <p className=\"text-sm text-slate-500\">\r\n          Showing {paginated.length} of {filtered.length} products\r\n          {typeFilter && typeFilter !== 'all' && ` (filtered by ${typeFilter})`}\r\n        </p>\r\n        <div className=\"flex gap-1\">\r\n          <button\r\n            onClick={() => updateState({ page: Math.max(0, page - 1) })}\r\n            disabled={page === 0}\r\n            className=\"px-3 py-1 rounded bg-slate-200 hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n          >\r\n            Previous\r\n          </button>\r\n          {Array.from({ length: Math.min(5, totalPages) }).map((_, i) => {\r\n            const pageNum = page < 3 ? i : page - 2 + i\r\n            if (pageNum >= totalPages) return null\r\n            return (\r\n              <button\r\n                key={pageNum}\r\n                onClick={() => updateState({ page: pageNum })}\r\n                className={`px-3 py-1 rounded text-sm ${\r\n                  pageNum === page\r\n                    ? 'bg-slate-800 text-white'\r\n                    : 'bg-slate-200 hover:bg-slate-300'\r\n                }`}\r\n              >\r\n                {pageNum + 1}\r\n              </button>\r\n            )\r\n          })}\r\n          <button\r\n            onClick={() => updateState({ page: Math.min(totalPages - 1, page + 1) })}\r\n            disabled={page >= totalPages - 1}\r\n            className=\"px-3 py-1 rounded bg-slate-200 hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n          >\r\n            Next\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport type { TableState }"],"names":["useState","Eye","Save","X","Edit2","Product","id","apcPN","customer","customerPN","buildRev","currentRev","description","fullPath","item_type_name","item_type_id","createdAt","TableState","search","sortKey","sortAsc","pageSize","page","typeFilter","Props","products","onView","product","onEdit","onSave","Promise","tableState","onTableStateChange","state","isAdmin","EditableProductTable","editingRow","setEditingRow","editedData","setEditedData","Partial","saving","setSaving","updateState","updates","productTypes","Array","from","Set","map","p","filter","t","undefined","sort","filtered","matchesSearch","toLowerCase","includes","matchesType","sorted","a","b","valA","valB","String","localeCompare","paginated","slice","totalPages","Math","ceil","length","handleStartEdit","handleCancelEdit","handleSaveEdit","error","console","handleFieldChange","field","value","prev","e","target","type","Number","size","isEditing","max","min","_","i","pageNum"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 759, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/ui/DataView.tsx"],"sourcesContent":["import { useState } from 'react'\r\n\r\n/**\r\n * Column metadata definition\r\n */\r\nexport type ColumnMetadata = {\r\n  [columnName: string]: {\r\n    hidden?: boolean      // Don't display at all\r\n    system?: boolean      // Available to system but not visible to users\r\n    readonly?: boolean    // Display but don't allow editing\r\n    required?: boolean    // Must have value in forms\r\n    label?: string        // Custom display label\r\n    type?: 'text' | 'number' | 'date' | 'textarea' | 'select'\r\n    options?: string[]    // For select type\r\n    width?: string        // Custom column width for tables\r\n  }\r\n}\r\n\r\nexport type DataViewProps = {\r\n  data: any[]\r\n  metadata?: ColumnMetadata\r\n  loading?: boolean\r\n  error?: string | null\r\n  emptyMessage?: string\r\n  title?: string\r\n  subtitle?: string\r\n  mode?: 'auto' | 'form' | 'table'  // auto = switch based on row count\r\n  editable?: boolean\r\n  onSave?: (data: any) => void\r\n  onChange?: (field: string, value: any) => void\r\n  formData?: any  // For controlled form mode\r\n}\r\n\r\nexport default function DataView({\r\n  data = [],\r\n  metadata = {},\r\n  loading = false,\r\n  error = null,\r\n  emptyMessage = 'No data available',\r\n  title,\r\n  subtitle,\r\n  mode = 'auto',\r\n  editable = false,\r\n  onSave,\r\n  onChange,\r\n  formData\r\n}: DataViewProps) {\r\n  const [localFormData, setLocalFormData] = useState<any>({})\r\n\r\n  // Determine display mode\r\n  const displayMode = mode === 'auto' \r\n    ? (data.length === 1 ? 'form' : 'table')\r\n    : mode\r\n\r\n  // Get visible columns based on metadata\r\n  const getVisibleColumns = (row: any) => {\r\n    return Object.keys(row).filter(key => {\r\n      const meta = metadata[key]\r\n      return !meta?.hidden && !meta?.system\r\n    })\r\n  }\r\n\r\n  // Get column label\r\n  const getColumnLabel = (key: string) => {\r\n    return metadata[key]?.label || key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())\r\n  }\r\n\r\n  // Check if field is readonly\r\n  const isReadOnly = (key: string) => {\r\n    return !editable || metadata[key]?.readonly\r\n  }\r\n\r\n  // Handle field change\r\n  const handleFieldChange = (field: string, value: any) => {\r\n    if (onChange) {\r\n      onChange(field, value)\r\n    } else {\r\n      setLocalFormData((prev: any) => ({ ...prev, [field]: value }))\r\n    }\r\n  }\r\n\r\n  // Get current form data (controlled or local)\r\n  const currentFormData = formData || localFormData\r\n\r\n  // Input styles\r\n  const inputClassName = \"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm\"\r\n  const readOnlyClassName = \"w-full px-3 py-2 border border-slate-300 rounded-lg bg-slate-50 cursor-not-allowed text-sm\"\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center py-8 text-slate-600\">\r\n        <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n        <p className=\"mt-2\">Loading data...</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Error state\r\n  if (error) {\r\n    return (\r\n      <div className=\"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg\">\r\n        <p className=\"font-semibold\">Error loading data</p>\r\n        <p className=\"text-sm\">{error}</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // Empty state\r\n  if (data.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-8 text-slate-500\">\r\n        {emptyMessage}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // FORM MODE (Single Row)\r\n  if (displayMode === 'form') {\r\n    const row = data[0]\r\n    const mergedData = { ...row, ...currentFormData }\r\n    const visibleColumns = getVisibleColumns(row)\r\n\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {title && (\r\n          <div className=\"mb-4\">\r\n            <h4 className=\"font-semibold text-slate-800\">{title}</h4>\r\n            {subtitle && <p className=\"text-sm text-slate-600\">{subtitle}</p>}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          {visibleColumns.map((key) => {\r\n            const meta = metadata[key]\r\n            const value = mergedData[key]\r\n            const readonly = isReadOnly(key)\r\n            const isTextarea = meta?.type === 'textarea'\r\n            const isSelect = meta?.type === 'select'\r\n\r\n            return (\r\n              <div key={key} className={isTextarea ? 'col-span-2' : ''}>\r\n                <label className=\"block text-sm font-medium text-slate-700 mb-1\">\r\n                  {getColumnLabel(key)}\r\n                  {meta?.required && <span className=\"text-red-500 ml-1\">*</span>}\r\n                </label>\r\n\r\n                {isTextarea ? (\r\n                  <textarea\r\n                    value={value || ''}\r\n                    onChange={(e) => handleFieldChange(key, e.target.value)}\r\n                    readOnly={readonly}\r\n                    rows={3}\r\n                    className={readonly ? readOnlyClassName : inputClassName}\r\n                  />\r\n                ) : isSelect && meta?.options ? (\r\n                  <select\r\n                    value={value || ''}\r\n                    onChange={(e) => handleFieldChange(key, e.target.value)}\r\n                    disabled={readonly}\r\n                    className={readonly ? readOnlyClassName : inputClassName}\r\n                  >\r\n                    <option value=\"\">Select...</option>\r\n                    {meta.options.map(opt => (\r\n                      <option key={opt} value={opt}>{opt}</option>\r\n                    ))}\r\n                  </select>\r\n                ) : (\r\n                  <input\r\n                    type={meta?.type || 'text'}\r\n                    value={value === null ? '' : value}\r\n                    onChange={(e) => handleFieldChange(key, e.target.value)}\r\n                    readOnly={readonly}\r\n                    className={readonly ? readOnlyClassName : inputClassName}\r\n                  />\r\n                )}\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n\r\n        {editable && onSave && (\r\n          <div className=\"flex justify-end pt-4\">\r\n            <button\r\n              onClick={() => onSave(mergedData)}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\r\n            >\r\n              Save Changes\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // TABLE MODE (Multiple Rows)\r\n  if (data.length > 0) {\r\n    const visibleColumns = getVisibleColumns(data[0])\r\n\r\n    return (\r\n      <div>\r\n        {title && (\r\n          <div className=\"mb-4\">\r\n            <h4 className=\"font-semibold text-slate-800\">\r\n              {title} ({data.length})\r\n            </h4>\r\n            {subtitle && <p className=\"text-sm text-slate-600\">{subtitle}</p>}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"border border-slate-200 rounded-lg overflow-x-auto max-h-96\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-slate-100 sticky top-0\">\r\n              <tr>\r\n                {visibleColumns.map((key) => (\r\n                  <th\r\n                    key={key}\r\n                    className=\"px-4 py-2 text-left font-medium text-slate-700 whitespace-nowrap\"\r\n                    style={{ width: metadata[key]?.width }}\r\n                  >\r\n                    {getColumnLabel(key)}\r\n                  </th>\r\n                ))}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {data.map((row, i) => (\r\n                <tr key={i} className=\"border-t border-slate-200 hover:bg-slate-50\">\r\n                  {visibleColumns.map((key) => (\r\n                    <td key={key} className=\"px-4 py-2 whitespace-nowrap text-slate-600\">\r\n                      {row[key] === null ? (\r\n                        <span className=\"text-slate-400 italic\">null</span>\r\n                      ) : (\r\n                        String(row[key])\r\n                      )}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return null\r\n}"],"names":["useState","ColumnMetadata","columnName","hidden","system","readonly","required","label","type","options","width","DataViewProps","data","metadata","loading","error","emptyMessage","title","subtitle","mode","editable","onSave","onChange","field","value","formData","DataView","t0","$","_c","$i","Symbol","for","t1","t2","t3","t4","t5","t6","t7","undefined","t8","t9","localFormData","setLocalFormData","displayMode","length","t10","row","Object","keys","filter","key","meta","getVisibleColumns","getColumnLabel","key_0","replace","_DataViewGetColumnLabelAnonymous","isReadOnly","key_1","handleFieldChange","DataView[handleFieldChange]","prev","currentFormData","t11","t12","row_0","mergedData","visibleColumns","map","key_2","meta_0","value_0","isTextarea","isSelect","e","target","e_0","_DataViewVisibleColumnsMapMeta_0OptionsMap","e_1","DataView[<button>.onClick]","visibleColumns_0","DataView[data.map()]","row_1","i","key_4","String","key_3","opt","l","toUpperCase"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1243, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/products/ProductView.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { X } from 'lucide-react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport DataView, { ColumnMetadata } from '@/components/ui/DataView'\r\n\r\ntype Product = {\r\n  id: number\r\n  apcPN: string\r\n  customer: string | null\r\n  customerPN: string | null\r\n  buildRev: string | null\r\n  currentRev: string | null\r\n  description: string | null\r\n  fullPath: string | null\r\n  item_type_name: string | null\r\n  item_type_code?: string | null\r\n  item_type_id: number\r\n  createdAt: string\r\n}\r\n\r\ntype ProductionData = {\r\n  [key: string]: any\r\n}\r\n\r\ntype ERPData = {\r\n  [key: string]: any\r\n}\r\n\r\ntype EngineeringData = {\r\n  [key: string]: any\r\n}\r\n\r\ntype Props = {\r\n  product: Product\r\n  onClose: () => void\r\n}\r\n\r\nexport default function ProductView({ product, onClose }: Props) {\r\n  const [activeTab, setActiveTab] = useState('base')\r\n  \r\n  // Production data state\r\n  const [productionData, setProductionData] = useState<ProductionData[]>([])\r\n  const [loadingProduction, setLoadingProduction] = useState(false)\r\n  const [productionError, setProductionError] = useState<string | null>(null)\r\n\r\n  // ERP data state\r\n  const [erpData, setErpData] = useState<ERPData[]>([])\r\n  const [loadingErp, setLoadingErp] = useState(false)\r\n  const [erpError, setErpError] = useState<string | null>(null)\r\n\r\n  // Engineering data state\r\n  const [engineeringData, setEngineeringData] = useState<EngineeringData[]>([])\r\n  const [loadingEngineering, setLoadingEngineering] = useState(false)\r\n  const [engineeringError, setEngineeringError] = useState<string | null>(null)\r\n\r\n  useEffect(() => {\r\n    fetchProductionData()\r\n    fetchERPData()\r\n    fetchEngineeringData()\r\n  }, [product.apcPN])\r\n\r\n  const fetchProductionData = async () => {\r\n    setLoadingProduction(true)\r\n    setProductionError(null)\r\n\r\n    try {\r\n      const res = await fetch('/api/products/production', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ apcPN: product.apcPN })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch production data')\r\n\r\n      const data = await res.json()\r\n      setProductionData(data.results || [])\r\n    } catch (error) {\r\n      console.error('Error fetching production data:', error)\r\n      setProductionError(error instanceof Error ? error.message : 'Failed to load production data')\r\n    } finally {\r\n      setLoadingProduction(false)\r\n    }\r\n  }\r\n\r\n  const fetchERPData = async () => {\r\n    setLoadingErp(true)\r\n    setErpError(null)\r\n\r\n    try {\r\n      const res = await fetch('/api/products/erp', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ apcPN: product.apcPN })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch ERP data')\r\n\r\n      const data = await res.json()\r\n      setErpData(data.results || [])\r\n    } catch (error) {\r\n      console.error('Error fetching ERP data:', error)\r\n      setErpError(error instanceof Error ? error.message : 'Failed to load ERP data')\r\n    } finally {\r\n      setLoadingErp(false)\r\n    }\r\n  }\r\n\r\n  const fetchEngineeringData = async () => {\r\n    setLoadingEngineering(true)\r\n    setEngineeringError(null)\r\n\r\n    try {\r\n      const res = await fetch('/api/products/engineering', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ apcPN: product.apcPN })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch engineering data')\r\n\r\n      const data = await res.json()\r\n      setEngineeringData(data.results || [])\r\n    } catch (error) {\r\n      console.error('Error fetching engineering data:', error)\r\n      setEngineeringError(error instanceof Error ? error.message : 'Failed to load engineering data')\r\n    } finally {\r\n      setLoadingEngineering(false)\r\n    }\r\n  }\r\n\r\n  // Metadata definitions for each data source\r\n  const baseMetadata: ColumnMetadata = {\r\n    id: { hidden: true },\r\n    item_type_id: { hidden: true },\r\n    apcPN: { label: 'APC Part Number', readonly: true },\r\n    item_type_name: { label: 'Type', readonly: true },\r\n    customer: { label: 'Customer' },\r\n    customerPN: { label: 'Customer Part Number' },\r\n    currentRev: { label: 'Part Revision' },\r\n    buildRev: { label: 'Build Revision' },\r\n    description: { label: 'Description', type: 'textarea' },\r\n    fullPath: { label: 'Full Path' },\r\n    createdAt: { label: 'Created At', readonly: true }\r\n  }\r\n\r\n  const productionMetadata: ColumnMetadata = {\r\n    // Example: Hide internal IDs, show important fields\r\n    internal_id: { system: true },\r\n    record_id: { hidden: true },\r\n    part_number: { label: 'Part Number', width: '150px' },\r\n    quantity: { label: 'Qty', type: 'number', width: '80px' },\r\n    work_order: { label: 'Work Order', width: '120px' },\r\n    status: { label: 'Status', width: '100px' },\r\n    created_date: { label: 'Created', width: '120px' },\r\n    // Add more fields based on your actual production table structure\r\n  }\r\n\r\n  const erpMetadata: ColumnMetadata = {\r\n    // Example ERP metadata\r\n    item_id: { hidden: true },\r\n    part_number: { label: 'Part Number', width: '150px' },\r\n    description: { label: 'Description', width: '200px' },\r\n    unit_price: { label: 'Unit Price', type: 'number', width: '100px' },\r\n    stock_qty: { label: 'In Stock', type: 'number', width: '80px' },\r\n    location: { label: 'Location', width: '120px' },\r\n    // Add more fields based on your ERP structure\r\n  }\r\n\r\n  const engineeringMetadata: ColumnMetadata = {\r\n    // Example engineering metadata\r\n    drawing_id: { hidden: true },\r\n    revision: { label: 'Revision', width: '80px' },\r\n    drawing_number: { label: 'Drawing Number', width: '150px' },\r\n    title: { label: 'Title', width: '200px' },\r\n    engineer: { label: 'Engineer', width: '120px' },\r\n    release_date: { label: 'Released', width: '120px' },\r\n    // Add more fields based on your engineering database structure\r\n  }\r\n\r\n  // Base Information Tab (using DataView in form mode)\r\n  const baseInfoTab = (\r\n    <DataView\r\n      data={[product]}\r\n      metadata={baseMetadata}\r\n      mode=\"form\"\r\n      editable={false}\r\n    />\r\n  )\r\n\r\n  // Production Information Tab (auto-switches between form/table)\r\n  const productionTab = (\r\n    <DataView\r\n      data={productionData}\r\n      metadata={productionMetadata}\r\n      loading={loadingProduction}\r\n      error={productionError}\r\n      emptyMessage={`No production data found for part ${product.apcPN}`}\r\n      title=\"Production Records\"\r\n      subtitle=\"Data from data0050 table (read-only)\"\r\n      editable={false}\r\n    />\r\n  )\r\n\r\n  // ERP Tab (auto-switches between form/table)\r\n  const erpTab = (\r\n    <DataView\r\n      data={erpData}\r\n      metadata={erpMetadata}\r\n      loading={loadingErp}\r\n      error={erpError}\r\n      emptyMessage={`No ERP data found for part ${product.apcPN}`}\r\n      title=\"ERP Information\"\r\n      subtitle=\"Data from ERP system (read-only)\"\r\n      editable={false}\r\n    />\r\n  )\r\n\r\n  // Engineering Tab (auto-switches between form/table)\r\n  const engineeringTab = (\r\n    <DataView\r\n      data={engineeringData}\r\n      metadata={engineeringMetadata}\r\n      loading={loadingEngineering}\r\n      error={engineeringError}\r\n      emptyMessage={`No engineering data found for part ${product.apcPN}`}\r\n      title=\"Engineering Reference\"\r\n      subtitle=\"Data from engineering database (read-only)\"\r\n      editable={false}\r\n    />\r\n  )\r\n\r\n  const tabs = [\r\n    { id: 'base', label: 'Base Information', content: baseInfoTab, closeable: false },\r\n    { id: 'production', label: 'Production', content: productionTab, closeable: false },\r\n    { id: 'erp', label: 'ERP Data', content: erpTab, closeable: false },\r\n    { id: 'engineering', label: 'Engineering', content: engineeringTab, closeable: false }\r\n  ]\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-slate-200\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold text-slate-800\">View Product: {product.apcPN}</h2>\r\n            <p className=\"text-sm text-slate-600 mt-1\">Product information (read-only)</p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            <X size={24} className=\"text-slate-600\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content with Tabs */}\r\n        <div className=\"flex-1 overflow-auto p-6\">\r\n          <Tabs tabs={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-3 p-6 border-t border-slate-200\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":["useState","useEffect","X","Tabs","DataView","ColumnMetadata","Product","id","apcPN","customer","customerPN","buildRev","currentRev","description","fullPath","item_type_name","item_type_code","item_type_id","createdAt","ProductionData","key","ERPData","EngineeringData","Props","product","onClose","ProductView","activeTab","setActiveTab","productionData","setProductionData","loadingProduction","setLoadingProduction","productionError","setProductionError","erpData","setErpData","loadingErp","setLoadingErp","erpError","setErpError","engineeringData","setEngineeringData","loadingEngineering","setLoadingEngineering","engineeringError","setEngineeringError","fetchProductionData","fetchERPData","fetchEngineeringData","res","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","results","error","console","message","baseMetadata","hidden","label","readonly","type","productionMetadata","internal_id","system","record_id","part_number","width","quantity","work_order","status","created_date","erpMetadata","item_id","unit_price","stock_qty","location","engineeringMetadata","drawing_id","revision","drawing_number","title","engineer","release_date","baseInfoTab","productionTab","erpTab","engineeringTab","tabs","content","closeable"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1672, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/ui/BOMTreeNavigator.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\r\nimport { ChevronRight, ChevronDown, Package, Loader2, AlertCircle, Maximize2 } from 'lucide-react'\r\n\r\nexport type BOMItem = {\r\n  id: string\r\n  part_number: string\r\n  description?: string\r\n  quantity: number\r\n  ref_des?: string\r\n  unit?: string\r\n  level: number\r\n  has_children?: boolean\r\n  children?: BOMItem[]\r\n}\r\n\r\ntype Props = {\r\n  rootPartNumber: string\r\n  onPartClick?: (partNumber: string) => void\r\n}\r\n\r\nexport default function BOMTreeNavigator({ rootPartNumber, onPartClick }: Props) {\r\n  const [bomTree, setBomTree] = useState<BOMItem[]>([])\r\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set())\r\n  const [loadingNodes, setLoadingNodes] = useState<Set<string>>(new Set())\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [expandingAll, setExpandingAll] = useState(false)\r\n\r\n  useEffect(() => {\r\n    fetchBOMRoot()\r\n  }, [rootPartNumber])\r\n\r\n  const fetchBOMRoot = async () => {\r\n    setLoading(true)\r\n    setError(null)\r\n\r\n    try {\r\n      const res = await fetch('/api/products/bom', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ \r\n          apcPN: rootPartNumber,\r\n          level: 0,\r\n          isInventoryPart: false  // Root is always a customer part\r\n        })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch BOM data')\r\n\r\n      const data = await res.json()\r\n      setBomTree(data.results || [])\r\n    } catch (error) {\r\n      console.error('Error fetching BOM:', error)\r\n      setError(error instanceof Error ? error.message : 'Failed to load BOM data')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const fetchBOMChildren = async (item: BOMItem) => {\r\n    setLoadingNodes(prev => new Set(prev).add(item.id))\r\n\r\n    try {\r\n      const res = await fetch('/api/products/bom', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ \r\n          apcPN: item.part_number,\r\n          level: item.level + 1,\r\n          isInventoryPart: true  // Children are always inventory parts\r\n        })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch child BOM data')\r\n\r\n      const data = await res.json()\r\n      \r\n      // Update the tree with children\r\n      setBomTree(prevTree => updateTreeWithChildren(prevTree, item.id, data.results || []))\r\n    } catch (error) {\r\n      console.error('Error fetching BOM children:', error)\r\n    } finally {\r\n      setLoadingNodes(prev => {\r\n        const newSet = new Set(prev)\r\n        newSet.delete(item.id)\r\n        return newSet\r\n      })\r\n    }\r\n  }\r\n\r\n  const updateTreeWithChildren = (tree: BOMItem[], nodeId: string, children: BOMItem[]): BOMItem[] => {\r\n    return tree.map(item => {\r\n      if (item.id === nodeId) {\r\n        return { ...item, children }\r\n      }\r\n      if (item.children) {\r\n        return { ...item, children: updateTreeWithChildren(item.children, nodeId, children) }\r\n      }\r\n      return item\r\n    })\r\n  }\r\n\r\n  const toggleNode = async (item: BOMItem) => {\r\n    const isExpanded = expandedNodes.has(item.id)\r\n\r\n    if (isExpanded) {\r\n      // Collapse\r\n      setExpandedNodes(prev => {\r\n        const newSet = new Set(prev)\r\n        newSet.delete(item.id)\r\n        return newSet\r\n      })\r\n    } else {\r\n      // Expand\r\n      setExpandedNodes(prev => new Set(prev).add(item.id))\r\n      \r\n      // Fetch children if not already loaded\r\n      if (item.has_children && (!item.children || item.children.length === 0)) {\r\n        await fetchBOMChildren(item)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Expand All functionality (for future use)\r\n  const expandAll = async () => {\r\n    setExpandingAll(true)\r\n    const nodesToExpand: BOMItem[] = []\r\n    \r\n    // Collect all expandable nodes\r\n    const collectNodes = (items: BOMItem[]) => {\r\n      items.forEach(item => {\r\n        if (item.has_children) {\r\n          nodesToExpand.push(item)\r\n        }\r\n        if (item.children) {\r\n          collectNodes(item.children)\r\n        }\r\n      })\r\n    }\r\n    \r\n    collectNodes(bomTree)\r\n    \r\n    // Expand all nodes\r\n    for (const node of nodesToExpand) {\r\n      if (!expandedNodes.has(node.id)) {\r\n        setExpandedNodes(prev => new Set(prev).add(node.id))\r\n        if (!node.children || node.children.length === 0) {\r\n          await fetchBOMChildren(node)\r\n        }\r\n      }\r\n    }\r\n    \r\n    setExpandingAll(false)\r\n  }\r\n\r\n  // Collapse All functionality\r\n  const collapseAll = () => {\r\n    setExpandedNodes(new Set())\r\n  }\r\n\r\n  const renderBOMItem = (item: BOMItem, depth: number = 0) => {\r\n    const isExpanded = expandedNodes.has(item.id)\r\n    const isLoading = loadingNodes.has(item.id)\r\n    const hasChildren = item.has_children || (item.children && item.children.length > 0)\r\n\r\n    return (\r\n      <div key={item.id}>\r\n        <div\r\n          className=\"flex items-center gap-2 py-2 px-3 hover:bg-slate-50 rounded cursor-pointer group\"\r\n          style={{ paddingLeft: `${depth * 24 + 12}px` }}\r\n        >\r\n          {/* Expand/Collapse Button */}\r\n          <button\r\n            onClick={() => hasChildren && toggleNode(item)}\r\n            className={`flex-shrink-0 ${hasChildren ? 'visible' : 'invisible'}`}\r\n            disabled={isLoading}\r\n          >\r\n            {isLoading ? (\r\n              <Loader2 size={16} className=\"animate-spin text-slate-400\" />\r\n            ) : isExpanded ? (\r\n              <ChevronDown size={16} className=\"text-slate-600\" />\r\n            ) : (\r\n              <ChevronRight size={16} className=\"text-slate-600\" />\r\n            )}\r\n          </button>\r\n\r\n          {/* Part Icon */}\r\n          <Package size={16} className=\"text-blue-600 flex-shrink-0\" />\r\n\r\n          {/* Part Info */}\r\n          <div \r\n            className=\"flex-1 flex items-center gap-4 min-w-0\"\r\n            onClick={() => onPartClick?.(item.part_number)}\r\n          >\r\n            <span className=\"font-mono text-sm font-medium text-slate-800\">\r\n              {item.part_number}\r\n            </span>\r\n            \r\n            <span className=\"text-sm text-slate-600 truncate\">\r\n              {item.description || '-'}\r\n            </span>\r\n\r\n            <span className=\"text-xs text-slate-500 font-medium ml-auto flex-shrink-0\">\r\n              Qty: {item.quantity} {item.unit || ''}\r\n            </span>\r\n\r\n            {item.ref_des && (\r\n              <span className=\"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded flex-shrink-0\">\r\n                {item.ref_des}\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Render children */}\r\n        {isExpanded && item.children && item.children.length > 0 && (\r\n          <div>\r\n            {item.children.map(child => renderBOMItem(child, depth + 1))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <Loader2 className=\"animate-spin text-blue-600 mr-2\" size={24} />\r\n        <span className=\"text-slate-600\">Loading BOM tree...</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700\">\r\n        <AlertCircle size={20} />\r\n        <div>\r\n          <p className=\"font-semibold\">Error loading BOM</p>\r\n          <p className=\"text-sm\">{error}</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (bomTree.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12 text-slate-500\">\r\n        <Package size={48} className=\"mx-auto mb-3 opacity-50\" />\r\n        <p>No BOM data found for {rootPartNumber}</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"border border-slate-200 rounded-lg overflow-hidden\">\r\n      {/* Header */}\r\n      <div className=\"bg-slate-100 px-4 py-3 border-b border-slate-200\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h3 className=\"font-semibold text-slate-800\">Bill of Materials</h3>\r\n            <span className=\"text-sm text-slate-600\">\r\n              Root: <span className=\"font-mono font-medium\">{rootPartNumber}</span>\r\n            </span>\r\n          </div>\r\n          \r\n          {/* Expand/Collapse All buttons (for future use) */}\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={expandAll}\r\n              disabled={expandingAll}\r\n              className=\"px-3 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-1\"\r\n              title=\"Expand all manufactured parts\"\r\n            >\r\n              {expandingAll ? (\r\n                <>\r\n                  <Loader2 size={14} className=\"animate-spin\" />\r\n                  Expanding...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Maximize2 size={14} />\r\n                  Expand All\r\n                </>\r\n              )}\r\n            </button>\r\n            <button\r\n              onClick={collapseAll}\r\n              className=\"px-3 py-1.5 text-xs bg-slate-600 text-white rounded hover:bg-slate-700 transition-colors\"\r\n              title=\"Collapse all nodes\"\r\n            >\r\n              Collapse All\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tree */}\r\n      <div className=\"max-h-[600px] overflow-y-auto\">\r\n        {bomTree.map(item => renderBOMItem(item, 0))}\r\n      </div>\r\n\r\n      {/* Legend */}\r\n      <div className=\"bg-slate-50 px-4 py-2 border-t border-slate-200 text-xs text-slate-600\">\r\n        💡 Click arrows to expand/collapse • Click part numbers to view details\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":["useState","useEffect","ChevronRight","ChevronDown","Package","Loader2","AlertCircle","Maximize2","BOMItem","id","part_number","description","quantity","ref_des","unit","level","has_children","children","Props","rootPartNumber","onPartClick","partNumber","BOMTreeNavigator","bomTree","setBomTree","expandedNodes","setExpandedNodes","Set","loadingNodes","setLoadingNodes","loading","setLoading","error","setError","expandingAll","setExpandingAll","fetchBOMRoot","res","fetch","method","headers","body","JSON","stringify","apcPN","isInventoryPart","ok","Error","data","json","results","console","message","fetchBOMChildren","item","prev","add","prevTree","updateTreeWithChildren","newSet","delete","tree","nodeId","map","toggleNode","isExpanded","has","length","expandAll","nodesToExpand","collectNodes","items","forEach","push","node","collapseAll","renderBOMItem","depth","isLoading","hasChildren","paddingLeft","child"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 2178, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/lib/metadata/columnMetadata.ts"],"sourcesContent":["import { ColumnMetadata } from '@/components/ui/DataView'\r\n\r\n// ============================================\r\n// PRODUCTION GENERAL (data0050)\r\n// ============================================\r\nexport const productionGeneralMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  record_id: { hidden: true },\r\n  created_by: { system: true },\r\n  modified_by: { system: true },\r\n  \r\n  // Add your visible fields here with custom labels\r\n  // Example:\r\n  // part_number: { \r\n  //   label: 'Part Number', \r\n  //   width: '150px',\r\n  //   readonly: true \r\n  // },\r\n  // quantity: { \r\n  //   label: 'Quantity', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // status: { \r\n  //   label: 'Status', \r\n  //   width: '120px' \r\n  // },\r\n}\r\n\r\n// ============================================\r\n// BOM (Bill of Materials)\r\n// ============================================\r\nexport const bomMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  BOM_PTR: { hidden: true },\r\n  INVENTORY_PTR: { hidden: true },\r\n  component_rkey: { hidden: true },\r\n  parent_part: { hidden: true },\r\n  eff_end: { hidden: true },\r\n  sequence: { hidden: true }, // Used for sorting but don't display\r\n  bom_header_key: { hidden: true },\r\n  parent_type: { hidden: true },\r\n  component_type: { system: true }, // P or M flag - for internal logic\r\n  \r\n  // Visible fields based on your actual query\r\n  component_part: { \r\n    label: 'Component Part', \r\n    width: '150px',\r\n    readonly: true\r\n  },\r\n  description: { \r\n    label: 'Description', \r\n    width: '250px' \r\n  },\r\n  quantity: { \r\n    label: 'Qty', \r\n    type: 'number', \r\n    width: '80px' \r\n  },\r\n  unit_ptr: { \r\n    label: 'Unit', \r\n    width: '60px' \r\n  },\r\n  ref_des: { \r\n    label: 'Reference Designators', \r\n    width: '200px' \r\n  },\r\n}\r\n\r\n// ============================================\r\n// WHERE USED\r\n// ============================================\r\nexport const whereUsedMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  \r\n  // Visible fields\r\n  // parent_part: { \r\n  //   label: 'Parent Part', \r\n  //   width: '150px' \r\n  // },\r\n  // parent_description: { \r\n  //   label: 'Parent Description', \r\n  //   width: '250px' \r\n  // },\r\n  // quantity_used: { \r\n  //   label: 'Qty Used', \r\n  //   type: 'number', \r\n  //   width: '80px' \r\n  // },\r\n}\r\n\r\n// ============================================\r\n// ROUTE\r\n// ============================================\r\nexport const routeMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  \r\n  // Visible fields\r\n  // operation_seq: { \r\n  //   label: 'Seq', \r\n  //   type: 'number', \r\n  //   width: '60px' \r\n  // },\r\n  // operation_code: { \r\n  //   label: 'Operation', \r\n  //   width: '120px' \r\n  // },\r\n  // work_center: { \r\n  //   label: 'Work Center', \r\n  //   width: '150px' \r\n  // },\r\n  // description: { \r\n  //   label: 'Description', \r\n  //   width: '250px' \r\n  // },\r\n  // setup_time: { \r\n  //   label: 'Setup (hrs)', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // run_time: { \r\n  //   label: 'Run (hrs)', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n}\r\n\r\n// ============================================\r\n// WORK ORDERS\r\n// ============================================\r\nexport const workOrdersMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  \r\n  // Visible fields\r\n  // work_order: { \r\n  //   label: 'Work Order', \r\n  //   width: '120px' \r\n  // },\r\n  // status: { \r\n  //   label: 'Status', \r\n  //   width: '100px' \r\n  // },\r\n  // quantity_ordered: { \r\n  //   label: 'Qty Ordered', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // quantity_complete: { \r\n  //   label: 'Qty Complete', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // due_date: { \r\n  //   label: 'Due Date', \r\n  //   width: '120px' \r\n  // },\r\n  // priority: { \r\n  //   label: 'Priority', \r\n  //   width: '80px' \r\n  // },\r\n}\r\n\r\n// ============================================\r\n// INVENTORY\r\n// ============================================\r\nexport const inventoryMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  \r\n  // Visible fields\r\n  // location: { \r\n  //   label: 'Location', \r\n  //   width: '120px' \r\n  // },\r\n  // lot_number: { \r\n  //   label: 'Lot #', \r\n  //   width: '120px' \r\n  // },\r\n  // quantity_on_hand: { \r\n  //   label: 'On Hand', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // quantity_allocated: { \r\n  //   label: 'Allocated', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // quantity_available: { \r\n  //   label: 'Available', \r\n  //   type: 'number', \r\n  //   width: '100px' \r\n  // },\r\n  // last_transaction: { \r\n  //   label: 'Last Transaction', \r\n  //   width: '150px' \r\n  // },\r\n}\r\n\r\n// ============================================\r\n// DISCREPANCY\r\n// ============================================\r\nexport const discrepancyMetadata: ColumnMetadata = {\r\n  // Hidden/System fields\r\n  RKEY: { hidden: true },\r\n  internal_id: { system: true },\r\n  \r\n  // Visible fields\r\n  // discrepancy_id: { \r\n  //   label: 'ID', \r\n  //   width: '100px' \r\n  // },\r\n  // discrepancy_type: { \r\n  //   label: 'Type', \r\n  //   width: '120px' \r\n  // },\r\n  // reported_date: { \r\n  //   label: 'Reported', \r\n  //   width: '120px' \r\n  // },\r\n  // description: { \r\n  //   label: 'Description', \r\n  //   width: '300px' \r\n  // },\r\n  // status: { \r\n  //   label: 'Status', \r\n  //   width: '100px' \r\n  // },\r\n  // assigned_to: { \r\n  //   label: 'Assigned To', \r\n  //   width: '120px' \r\n  // },\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAKO,MAAM,4BAA4C;IACvD,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;IAC5B,WAAW;QAAE,QAAQ;IAAK;IAC1B,YAAY;QAAE,QAAQ;IAAK;IAC3B,aAAa;QAAE,QAAQ;IAAK;AAkB9B;AAKO,MAAM,cAA8B;IACzC,uBAAuB;IACvB,SAAS;QAAE,QAAQ;IAAK;IACxB,eAAe;QAAE,QAAQ;IAAK;IAC9B,gBAAgB;QAAE,QAAQ;IAAK;IAC/B,aAAa;QAAE,QAAQ;IAAK;IAC5B,SAAS;QAAE,QAAQ;IAAK;IACxB,UAAU;QAAE,QAAQ;IAAK;IACzB,gBAAgB;QAAE,QAAQ;IAAK;IAC/B,aAAa;QAAE,QAAQ;IAAK;IAC5B,gBAAgB;QAAE,QAAQ;IAAK;IAE/B,4CAA4C;IAC5C,gBAAgB;QACd,OAAO;QACP,OAAO;QACP,UAAU;IACZ;IACA,aAAa;QACX,OAAO;QACP,OAAO;IACT;IACA,UAAU;QACR,OAAO;QACP,MAAM;QACN,OAAO;IACT;IACA,UAAU;QACR,OAAO;QACP,OAAO;IACT;IACA,SAAS;QACP,OAAO;QACP,OAAO;IACT;AACF;AAKO,MAAM,oBAAoC;IAC/C,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;AAgB9B;AAKO,MAAM,gBAAgC;IAC3C,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;AA8B9B;AAKO,MAAM,qBAAqC;IAChD,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;AA6B9B;AAKO,MAAM,oBAAoC;IAC/C,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;AA8B9B;AAKO,MAAM,sBAAsC;IACjD,uBAAuB;IACvB,MAAM;QAAE,QAAQ;IAAK;IACrB,aAAa;QAAE,QAAQ;IAAK;AA2B9B","debugId":null}},
    {"offset": {"line": 2317, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/components/products/ProductEdit.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Save, X, FileText, Package, GitBranch, Route as RouteIcon, ClipboardList, Archive, AlertTriangle, Factory } from 'lucide-react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport DataView from '@/components/ui/DataView'\r\nimport BOMTreeNavigator from '@/components/ui/BOMTreeNavigator'\r\nimport { \r\n  productionGeneralMetadata,\r\n  whereUsedMetadata,\r\n  routeMetadata,\r\n  workOrdersMetadata,\r\n  inventoryMetadata,\r\n  discrepancyMetadata\r\n} from '@/lib/metadata/columnMetadata'\r\n\r\ntype Product = {\r\n  id: number\r\n  apcPN: string\r\n  customer: string | null\r\n  customerPN: string | null\r\n  currentRev: string | null\r\n  buildRev: string | null\r\n  description: string | null\r\n  fullPath: string | null\r\n  item_type_name: string | null\r\n  item_type_id: number\r\n  createdAt: string\r\n}\r\n\r\ntype ProductionData = {\r\n  [key: string]: any\r\n}\r\n\r\ntype Props = {\r\n  product: Product\r\n  onSave: (product: Product) => void\r\n  onCancel: () => void\r\n}\r\n\r\nexport default function ProductEdit({ product, onSave, onCancel }: Props) {\r\n  const [formData, setFormData] = useState(product)\r\n  const [hasChanges, setHasChanges] = useState(false)\r\n  const [activeTab, setActiveTab] = useState('general')\r\n  const [activeProductionTab, setActiveProductionTab] = useState('prod-general')\r\n\r\n  // Production data states\r\n  const [productionGeneralData, setProductionGeneralData] = useState<ProductionData[]>([])\r\n  const [loadingProdGeneral, setLoadingProdGeneral] = useState(false)\r\n  const [prodGeneralError, setProdGeneralError] = useState<string | null>(null)\r\n\r\n  // Where Used data states\r\n  const [whereUsedData, setWhereUsedData] = useState<ProductionData[]>([])\r\n  const [loadingWhereUsed, setLoadingWhereUsed] = useState(false)\r\n  const [whereUsedError, setWhereUsedError] = useState<string | null>(null)\r\n\r\n  // Route data states\r\n  const [routeData, setRouteData] = useState<ProductionData[]>([])\r\n  const [loadingRoute, setLoadingRoute] = useState(false)\r\n  const [routeError, setRouteError] = useState<string | null>(null)\r\n\r\n  // Work Orders data states\r\n  const [workOrdersData, setWorkOrdersData] = useState<ProductionData[]>([])\r\n  const [loadingWorkOrders, setLoadingWorkOrders] = useState(false)\r\n  const [workOrdersError, setWorkOrdersError] = useState<string | null>(null)\r\n\r\n  // Inventory data states\r\n  const [inventoryData, setInventoryData] = useState<ProductionData[]>([])\r\n  const [loadingInventory, setLoadingInventory] = useState(false)\r\n  const [inventoryError, setInventoryError] = useState<string | null>(null)\r\n\r\n  // Discrepancy data states\r\n  const [discrepancyData, setDiscrepancyData] = useState<ProductionData[]>([])\r\n  const [loadingDiscrepancy, setLoadingDiscrepancy] = useState(false)\r\n  const [discrepancyError, setDiscrepancyError] = useState<string | null>(null)\r\n\r\n  useEffect(() => {\r\n    // Load production data when Production tab is active\r\n    if (activeTab === 'production') {\r\n      if (activeProductionTab === 'prod-general') {\r\n        fetchProductionGeneralData()\r\n      }\r\n      // Add other fetch calls as needed when those tabs are clicked\r\n    }\r\n  }, [activeTab, activeProductionTab, product.apcPN])\r\n\r\n  const fetchProductionGeneralData = async () => {\r\n    setLoadingProdGeneral(true)\r\n    setProdGeneralError(null)\r\n\r\n    try {\r\n      const res = await fetch('/api/products/production', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ apcPN: product.apcPN })\r\n      })\r\n\r\n      if (!res.ok) throw new Error('Failed to fetch production data')\r\n\r\n      const data = await res.json()\r\n      setProductionGeneralData(data.results || [])\r\n    } catch (error) {\r\n      console.error('Error fetching production data:', error)\r\n      setProdGeneralError(error instanceof Error ? error.message : 'Failed to load production data')\r\n    } finally {\r\n      setLoadingProdGeneral(false)\r\n    }\r\n  }\r\n\r\n  const handleChange = (field: string, value: any) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }))\r\n    setHasChanges(true)\r\n  }\r\n\r\n  const handleSave = () => {\r\n    onSave(formData)\r\n    setHasChanges(false)\r\n  }\r\n\r\n  // Metadata for base (editable) fields\r\n  const baseMetadata = {\r\n    id: { hidden: true },\r\n    item_type_id: { hidden: true },\r\n    apcPN: { label: 'APC Part Number', readonly: true },\r\n    item_type_name: { label: 'Type', readonly: true },\r\n    customer: { label: 'Customer', required: false },\r\n    customerPN: { label: 'Customer Part Number' },\r\n    currentRev: { label: 'Part Revision' },\r\n    buildRev: { label: 'Build Revision' },\r\n    description: { label: 'Description', type: 'textarea' as const },\r\n    fullPath: { label: 'Full Path' },\r\n    createdAt: { hidden: true }\r\n  }\r\n\r\n  // ========================================\r\n  // TAB 1: GENERAL (Editable)\r\n  // ========================================\r\n  const generalTab = (\r\n    <div className=\"space-y-4\">\r\n      <DataView\r\n        data={[product]}\r\n        metadata={baseMetadata}\r\n        mode=\"form\"\r\n        editable={true}\r\n        onChange={handleChange}\r\n        formData={formData}\r\n      />\r\n\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n        <p className=\"text-sm text-blue-800\">\r\n          <strong>Note:</strong> General information is editable. Production and Engineering data are read-only.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // ========================================\r\n  // TAB 2: PRODUCTION (with vertical sub-tabs)\r\n  // ========================================\r\n  const productionTab = (\r\n    <div className=\"flex h-full gap-6\">\r\n      {/* Left Sidebar - Vertical Production Sub-tabs */}\r\n      <div className=\"w-48 flex-shrink-0\">\r\n        <nav className=\"space-y-1\">\r\n          {[\r\n            { id: 'prod-general', label: 'General', icon: ClipboardList },\r\n            { id: 'prod-bom', label: 'BOM', icon: Package },\r\n            { id: 'prod-whereused', label: 'Where Used', icon: GitBranch },\r\n            { id: 'prod-route', label: 'Route', icon: RouteIcon },\r\n            { id: 'prod-workorders', label: 'Work Orders', icon: ClipboardList },\r\n            { id: 'prod-inventory', label: 'Inventory', icon: Archive },\r\n            { id: 'prod-discrepancy', label: 'Discrepancy', icon: AlertTriangle }\r\n          ].map((tab) => {\r\n            const Icon = tab.icon\r\n            const isActive = activeProductionTab === tab.id\r\n            \r\n            return (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveProductionTab(tab.id)}\r\n                className={`\r\n                  w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors\r\n                  ${isActive \r\n                    ? 'bg-blue-600 text-white' \r\n                    : 'text-slate-700 hover:bg-slate-100'\r\n                  }\r\n                `}\r\n              >\r\n                <Icon size={18} />\r\n                <span className=\"flex-1 text-left\">{tab.label}</span>\r\n              </button>\r\n            )\r\n          })}\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Right Content Area - Production Data */}\r\n      <div className=\"flex-1 min-w-0\">\r\n        {activeProductionTab === 'prod-general' && (\r\n          <DataView\r\n            data={productionGeneralData}\r\n            metadata={productionGeneralMetadata}\r\n            loading={loadingProdGeneral}\r\n            error={prodGeneralError}\r\n            emptyMessage={`No production data found for part ${formData.apcPN}`}\r\n            title=\"Production General\"\r\n            subtitle=\"Data from data0050 table (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-bom' && (\r\n          <BOMTreeNavigator\r\n            rootPartNumber={formData.apcPN}\r\n            onPartClick={(partNumber) => {\r\n              console.log('Clicked part:', partNumber)\r\n              // TODO: Navigate to that part or show details\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-whereused' && (\r\n          <DataView\r\n            data={whereUsedData}\r\n            metadata={whereUsedMetadata}\r\n            loading={loadingWhereUsed}\r\n            error={whereUsedError}\r\n            emptyMessage={`No where-used data found for part ${formData.apcPN}`}\r\n            title=\"Where Used\"\r\n            subtitle=\"Parent assemblies (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-route' && (\r\n          <DataView\r\n            data={routeData}\r\n            metadata={routeMetadata}\r\n            loading={loadingRoute}\r\n            error={routeError}\r\n            emptyMessage={`No route data found for part ${formData.apcPN}`}\r\n            title=\"Route\"\r\n            subtitle=\"Manufacturing route (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-workorders' && (\r\n          <DataView\r\n            data={workOrdersData}\r\n            metadata={workOrdersMetadata}\r\n            loading={loadingWorkOrders}\r\n            error={workOrdersError}\r\n            emptyMessage={`No work orders found for part ${formData.apcPN}`}\r\n            title=\"Work Orders\"\r\n            subtitle=\"Work order history (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-inventory' && (\r\n          <DataView\r\n            data={inventoryData}\r\n            metadata={inventoryMetadata}\r\n            loading={loadingInventory}\r\n            error={inventoryError}\r\n            emptyMessage={`No inventory data found for part ${formData.apcPN}`}\r\n            title=\"Inventory\"\r\n            subtitle=\"Inventory levels (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n\r\n        {activeProductionTab === 'prod-discrepancy' && (\r\n          <DataView\r\n            data={discrepancyData}\r\n            metadata={discrepancyMetadata}\r\n            loading={loadingDiscrepancy}\r\n            error={discrepancyError}\r\n            emptyMessage={`No discrepancies found for part ${formData.apcPN}`}\r\n            title=\"Discrepancy\"\r\n            subtitle=\"Discrepancy reports (read-only)\"\r\n            editable={false}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  // ========================================\r\n  // TAB 3: ENGINEERING (Coming Soon)\r\n  // ========================================\r\n  const engineeringTab = (\r\n    <div className=\"flex flex-col items-center justify-center py-16 text-slate-500\">\r\n      <Factory size={64} className=\"mb-4 opacity-50\" />\r\n      <h3 className=\"text-xl font-semibold mb-2\">Engineering Data</h3>\r\n      <p className=\"text-sm\">Coming soon - provide database details</p>\r\n    </div>\r\n  )\r\n\r\n  // Top-level horizontal tabs\r\n  const topLevelTabs = [\r\n    { id: 'general', label: 'General', content: generalTab, closeable: false },\r\n    { id: 'production', label: 'Production', content: productionTab, closeable: false },\r\n    { id: 'engineering', label: 'Engineering', content: engineeringTab, closeable: false }\r\n  ]\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Action Bar */}\r\n      <div className=\"flex items-center justify-between px-6 py-4 border-b border-slate-200\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold text-slate-800\">\r\n            Editing: {formData.apcPN}\r\n          </h3>\r\n          {hasChanges && (\r\n            <p className=\"text-sm text-orange-600 mt-1\">\r\n              ⚠️ You have unsaved changes\r\n            </p>\r\n          )}\r\n        </div>\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            onClick={onCancel}\r\n            className=\"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors flex items-center gap-2\"\r\n          >\r\n            <X size={18} />\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            disabled={!hasChanges}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <Save size={18} />\r\n            Save Changes\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content with Tabs */}\r\n      <div className=\"flex-1 overflow-auto px-6 py-4\">\r\n        <Tabs tabs={topLevelTabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":["useState","useEffect","Save","X","FileText","Package","GitBranch","Route","RouteIcon","ClipboardList","Archive","AlertTriangle","Factory","Tabs","DataView","BOMTreeNavigator","productionGeneralMetadata","whereUsedMetadata","routeMetadata","workOrdersMetadata","inventoryMetadata","discrepancyMetadata","Product","id","apcPN","customer","customerPN","currentRev","buildRev","description","fullPath","item_type_name","item_type_id","createdAt","ProductionData","key","Props","product","onSave","onCancel","ProductEdit","formData","setFormData","hasChanges","setHasChanges","activeTab","setActiveTab","activeProductionTab","setActiveProductionTab","productionGeneralData","setProductionGeneralData","loadingProdGeneral","setLoadingProdGeneral","prodGeneralError","setProdGeneralError","whereUsedData","setWhereUsedData","loadingWhereUsed","setLoadingWhereUsed","whereUsedError","setWhereUsedError","routeData","setRouteData","loadingRoute","setLoadingRoute","routeError","setRouteError","workOrdersData","setWorkOrdersData","loadingWorkOrders","setLoadingWorkOrders","workOrdersError","setWorkOrdersError","inventoryData","setInventoryData","loadingInventory","setLoadingInventory","inventoryError","setInventoryError","discrepancyData","setDiscrepancyData","loadingDiscrepancy","setLoadingDiscrepancy","discrepancyError","setDiscrepancyError","fetchProductionGeneralData","res","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","results","error","console","message","handleChange","field","value","prev","handleSave","baseMetadata","hidden","label","readonly","required","type","const","generalTab","productionTab","icon","map","tab","Icon","isActive","partNumber","log","engineeringTab","topLevelTabs","content","closeable"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 2888, "column": 0}, "map": {"version":3,"sources":["file:///users/mrzasa/projects/current/frontend2.4/app/%28dashboard%29/products/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport Tabs from '@/components/ui/Tabs'\r\nimport EditableProductTable, { TableState, DEFAULT_TYPE_FILTER, DEFAULT_SORT_KEY, DEFAULT_SORT_ASC } from '@/components/products/EditableProductTable'\r\nimport ProductView from '@/components/products/ProductView'\r\nimport ProductEdit from '@/components/products/ProductEdit'\r\nimport { Plus } from 'lucide-react'\r\nimport { useSession } from 'next-auth/react'\r\n\r\ntype Product = {\r\n  id: number\r\n  apcPN: string\r\n  customer: string | null\r\n  customerPN: string | null\r\n  buildRev: string | null\r\n  currentRev: string | null\r\n  description: string | null\r\n  fullPath: string | null\r\n  item_type_name: string | null\r\n  item_type_code?: string | null\r\n  item_type_id: number\r\n  createdAt: string\r\n}\r\n\r\nexport default function ProductsPage() {\r\n  const { data: session } = useSession()\r\n  const [products, setProducts] = useState<Product[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [viewProduct, setViewProduct] = useState<Product | null>(null)\r\n  const [editingProducts, setEditingProducts] = useState<Product[]>([])\r\n  const [activeTab, setActiveTab] = useState('all')\r\n  \r\n  // Initialize with default filters (Circuit Card Assembly, sorted by part number descending)\r\n  const [tableState, setTableState] = useState<TableState>({\r\n    search: '',\r\n    sortKey: DEFAULT_SORT_KEY,        // 'apcPN'\r\n    sortAsc: DEFAULT_SORT_ASC,        // false (descending = biggest first)\r\n    pageSize: 25,\r\n    page: 0,\r\n    typeFilter: DEFAULT_TYPE_FILTER   // 'Circuit Card Assembly'\r\n  })\r\n\r\n  // Check if user is admin\r\n  const isAdmin = session?.user?.roles?.includes('admin') || false\r\n\r\n  useEffect(() => {\r\n    fetchProducts()\r\n  }, [])\r\n\r\n  const fetchProducts = async () => {\r\n    try {\r\n      setLoading(true)\r\n      setError(null)\r\n      \r\n      const res = await fetch('/api/products')\r\n      \r\n      if (!res.ok) {\r\n        throw new Error(`Failed to fetch products: ${res.status}`)\r\n      }\r\n      \r\n      const data = await res.json()\r\n      setProducts(data)\r\n    } catch (error) {\r\n      console.error('Error fetching products:', error)\r\n      setError(error instanceof Error ? error.message : 'Failed to load products')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleView = (product: Product) => {\r\n    setViewProduct(product)\r\n  }\r\n\r\n  const handleEdit = (product: Product) => {\r\n    const alreadyEditing = editingProducts.find(p => p.id === product.id)\r\n    if (!alreadyEditing) {\r\n      setEditingProducts(prev => [...prev, product])\r\n    }\r\n    setActiveTab(`edit-${product.id}`)\r\n  }\r\n\r\n  const handleCloseEditTab = (productId: number) => {\r\n    setEditingProducts(prev => prev.filter(p => p.id !== productId))\r\n    setActiveTab('all')\r\n  }\r\n\r\n  const handleInlineSave = async (product: Product) => {\r\n    try {\r\n      const res = await fetch(`/api/products/${product.id}`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(product),\r\n      })\r\n      \r\n      if (!res.ok) {\r\n        const responseData = await res.json()\r\n        throw new Error(responseData.error || 'Failed to save product')\r\n      }\r\n      \r\n      await fetchProducts()\r\n      \r\n    } catch (error) {\r\n      console.error('Error saving product:', error)\r\n      alert(`Failed to save product: ${error instanceof Error ? error.message : 'Unknown error'}`)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  const handleSave = async (product: Product) => {\r\n    try {\r\n      const res = await fetch(`/api/products/${product.id}`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(product),\r\n      })\r\n      \r\n      if (!res.ok) {\r\n        const responseData = await res.json()\r\n        throw new Error(responseData.error || 'Failed to save product')\r\n      }\r\n      \r\n      await fetchProducts()\r\n      handleCloseEditTab(product.id)\r\n      \r\n    } catch (error) {\r\n      console.error('Error saving product:', error)\r\n      alert(`Failed to save product: ${error instanceof Error ? error.message : 'Unknown error'}`)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-8 bg-slate-200 rounded w-1/4 mb-4\"></div>\r\n          <div className=\"h-64 bg-slate-200 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\r\n          <p className=\"font-semibold\">Error loading products</p>\r\n          <p className=\"text-sm\">{error}</p>\r\n          <button \r\n            onClick={fetchProducts}\r\n            className=\"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const productListTab = (\r\n    <div>\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h3 className=\"text-lg font-semibold text-slate-800\">\r\n          All Products ({products.length})\r\n        </h3>\r\n        <button className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\">\r\n          <Plus size={18} />\r\n          Add Product\r\n        </button>\r\n      </div>\r\n      <EditableProductTable \r\n        products={products} \r\n        onView={handleView} \r\n        onEdit={handleEdit}\r\n        onSave={handleInlineSave}\r\n        tableState={tableState}\r\n        onTableStateChange={setTableState}\r\n        isAdmin={isAdmin}\r\n      />\r\n    </div>\r\n  )\r\n\r\n  const tabs = [\r\n    { \r\n      id: 'all', \r\n      label: 'All Products', \r\n      content: productListTab,\r\n      closeable: false\r\n    },\r\n    ...editingProducts.map(product => ({\r\n      id: `edit-${product.id}`,\r\n      label: product.apcPN,\r\n      content: (\r\n        <ProductEdit\r\n          product={product}\r\n          onSave={handleSave}\r\n          onCancel={() => handleCloseEditTab(product.id)}\r\n        />\r\n      ),\r\n      closeable: true,\r\n      onClose: () => handleCloseEditTab(product.id)\r\n    }))\r\n  ]\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h2 className=\"text-2xl font-bold text-slate-800 mb-2\">Products</h2>\r\n      <p className=\"text-slate-600 mb-6\">Manage product catalog and specifications</p>\r\n\r\n      <div className=\"bg-white rounded-lg shadow\">\r\n        <div className=\"p-6\">\r\n          <Tabs tabs={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\r\n        </div>\r\n      </div>\r\n\r\n      {viewProduct && (\r\n        <ProductView\r\n          product={viewProduct}\r\n          onClose={() => setViewProduct(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":["useState","useEffect","Tabs","EditableProductTable","TableState","DEFAULT_TYPE_FILTER","DEFAULT_SORT_KEY","DEFAULT_SORT_ASC","ProductView","ProductEdit","Plus","useSession","Product","id","apcPN","customer","customerPN","buildRev","currentRev","description","fullPath","item_type_name","item_type_code","item_type_id","createdAt","ProductsPage","data","session","products","setProducts","loading","setLoading","error","setError","viewProduct","setViewProduct","editingProducts","setEditingProducts","activeTab","setActiveTab","tableState","setTableState","search","sortKey","sortAsc","pageSize","page","typeFilter","isAdmin","user","roles","includes","fetchProducts","res","fetch","ok","Error","status","json","console","message","handleView","product","handleEdit","alreadyEditing","find","p","prev","handleCloseEditTab","productId","filter","handleInlineSave","method","headers","body","JSON","stringify","responseData","alert","handleSave","productListTab","length","tabs","label","content","closeable","map","onClose"],"mappings":"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","ignoreList":[],"debugId":null}}]
}